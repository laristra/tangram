<!--
This file is part of the Ristra tangram project.
Please see the license file at the root of this repository, or at:
https://github.com/laristra/tangram/blob/master/LICENSE
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="generator" content="Doxygen 1.8.13"/>
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <!-- Font stuff -->
    <link href='//fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'/>
    <script src="//use.fontawesome.com/3dce4d8e65.js"></script>
    <!-- the default version jquery provided by doxygen is too old for bootstrap
	 but it also contains local modifications.  we have extracted those that
	 are needed so that we can use a newer jquery. -->
    <!-- <script type="text/javascript" src="//code.jquery.com/jquery-3.1.1.min.js"></script> -->
    <script
			  src="//code.jquery.com/jquery-3.3.1.min.js"
			  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
			  crossorigin="anonymous"></script>
      <!-- <script src="//code.jquery.com/jquery-3.3.1.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
    <script type="text/javascript" src="smartmenu.js"></script>
    <title>tangram: /home/portage/tangram/tangram/support/MatPoly.h Source File</title>
    <link href="tabs.css" rel="stylesheet" type="text/css">
      <!-- this version is too old for bootstrap, but it includes modifications
	   from standard jquery
    <script type="text/javascript" src="jquery.js"></script>  -->
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="//stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="//stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/> -->
    <!-- <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
  </head>
  <body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand">tangram </a>
        </div>
      </div>
    </nav>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div class="content" id="content">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 panel " style="padding-bottom: 15px;">
              <div style="margin-bottom: 15px;">
      		<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_043c38e9c2239d2104f02eee845ed8d8.html">tangram</a></li><li class="navelem"><a class="el" href="dir_ac77909c0f1db96f6644ae8bc968ffe2.html">support</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MatPoly.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="MatPoly_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> This file is part of the Ristra tangram project.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> Please see the license file at the root of this repository, or at:</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> https://github.com/laristra/tangram/blob/master/LICENSE</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#ifndef TANGRAM_MATPOLY_H_</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define TANGRAM_MATPOLY_H_</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;numeric&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tangram_8h.html">tangram/support/tangram.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceTangram.html">Tangram</a> {</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespaceTangram.html#a4184eb3e83186cdabf000f3129adca24">   19</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTangram.html#a4184eb3e83186cdabf000f3129adca24">polygon3d_area</a>(<span class="keyword">const</span> std::vector&lt;Point3&gt;&amp; points,</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                      <span class="keyword">const</span> std::vector&lt;int&gt;&amp; poly_vertices) {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">double</span> poly_area = 0.0;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordtype">int</span> nvrts = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(poly_vertices.size());</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordflow">if</span> (nvrts == 3) {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    poly_area = 0.5*<a class="code" href="namespaceTangram.html#a84b9705686c77f9e2022cf7cffb8435c">cross</a>(points[poly_vertices[1]] - points[poly_vertices[0]], </div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      points[poly_vertices[2]] - points[poly_vertices[0]]).norm();</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span> (std::fabs(poly_area) &lt;= std::numeric_limits&lt;double&gt;::epsilon())</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  }</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="classTangram_1_1Point.html">Point3</a> gcenter;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; nvrts; ivrt++)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    gcenter += points[poly_vertices[ivrt]];</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  gcenter /= nvrts;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  </div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; nvrts; ivrt++) {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">int</span> ifv = poly_vertices[ivrt];</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">int</span> isv = poly_vertices[(ivrt + 1)%nvrts];</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">double</span> tri_size = </div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      0.5*<a class="code" href="namespaceTangram.html#a84b9705686c77f9e2022cf7cffb8435c">cross</a>(points[isv] - points[ifv], gcenter - points[ifv]).norm();</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (std::fabs(tri_size) &gt; std::numeric_limits&lt;double&gt;::epsilon())</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      poly_area += tri_size;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">if</span> (std::fabs(poly_area) &lt;= std::numeric_limits&lt;double&gt;::epsilon())</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">return</span> poly_area;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="namespaceTangram.html#addba9ffa7e87ee10c307576b5cfbc2ae">   53</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTangram.html#addba9ffa7e87ee10c307576b5cfbc2ae">polygon3d_moments</a>(<span class="keyword">const</span> std::vector&lt;Point3&gt;&amp; points,</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                       <span class="keyword">const</span> std::vector&lt;int&gt;&amp; poly_vertices,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                       std::vector&lt;double&gt;&amp; poly_moments) {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  poly_moments.assign(4, 0.0);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">int</span> nvrts = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(poly_vertices.size());</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (nvrts == 3) {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    poly_moments[0] = 0.5*<a class="code" href="namespaceTangram.html#a84b9705686c77f9e2022cf7cffb8435c">cross</a>(points[poly_vertices[1]] - points[poly_vertices[0]], </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      points[poly_vertices[2]] - points[poly_vertices[0]]).norm();</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (std::fabs(poly_moments[0]) &lt;= std::numeric_limits&lt;double&gt;::epsilon())</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      poly_moments[0] = 0.0;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; 3; ivrt++)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; 3; idim++)</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          poly_moments[idim + 1] += points[poly_vertices[ivrt]][idim];</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; 3; idim++)    </div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        poly_moments[idim + 1] *= poly_moments[0]/3.0;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classTangram_1_1Point.html">Point3</a> gcenter;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; nvrts; ivrt++)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    gcenter += points[poly_vertices[ivrt]];</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  gcenter /= nvrts;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  </div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; nvrts; ivrt++) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">int</span> ifv = poly_vertices[ivrt];</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">int</span> isv = poly_vertices[(ivrt + 1)%nvrts];</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">double</span> tri_size = </div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      0.5*<a class="code" href="namespaceTangram.html#a84b9705686c77f9e2022cf7cffb8435c">cross</a>(points[isv] - points[ifv], gcenter - points[ifv]).norm();</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (std::fabs(tri_size) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      poly_moments[0] += tri_size;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; 3; idim++)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        poly_moments[idim + 1] += </div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;          tri_size*(points[ifv][idim] + points[isv][idim] + gcenter[idim])/3.0;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> (std::fabs(poly_moments[0]) &lt;= std::numeric_limits&lt;double&gt;::epsilon())</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    poly_moments.assign(4, 0.0);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;}</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="namespaceTangram.html#afddb4621ade732fd64b8523a9475054b">   99</a></span>&#160;<a class="code" href="classTangram_1_1Vector.html">Vector&lt;3&gt;</a> <a class="code" href="namespaceTangram.html#afddb4621ade732fd64b8523a9475054b">polygon3d_normal</a>(<span class="keyword">const</span> std::vector&lt;Point3&gt;&amp; points,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                           <span class="keyword">const</span> std::vector&lt;int&gt;&amp; poly_vertices) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  std::vector&lt;double&gt; poly_moments;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="namespaceTangram.html#addba9ffa7e87ee10c307576b5cfbc2ae">polygon3d_moments</a>(points, poly_vertices, poly_moments);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="classTangram_1_1Vector.html">Vector3</a> poly_normal(0.0, 0.0, 0.0);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">if</span> (poly_moments[0] &lt;= std::numeric_limits&lt;double&gt;::epsilon())</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">return</span> poly_normal;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="classTangram_1_1Point.html">Point3</a> poly_centroid;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; 3; idim++)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    poly_centroid[idim] = poly_moments[idim + 1]/poly_moments[0];</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">int</span> nvrts = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(poly_vertices.size());</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; nvrts; ivrt++) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="classTangram_1_1Vector.html">Vector3</a> tri_normal = <a class="code" href="namespaceTangram.html#a84b9705686c77f9e2022cf7cffb8435c">cross</a>(points[poly_vertices[ivrt]] - poly_centroid,</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                               points[poly_vertices[(ivrt + 1)%nvrts]] - poly_centroid);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    poly_normal += tri_normal;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  poly_normal.<a class="code" href="classTangram_1_1Vector.html#a15d0c4cf8f5b7529f4e0895ab6e6c933">normalize</a>();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">return</span> poly_normal;  </div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> D&gt;</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html">  124</a></span>&#160;<span class="keyword">class </span><a class="code" href="classTangram_1_1MatPoly.html">MatPoly</a> {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#acc2a5d89ddc811f6acb3ef4d4780d753">  130</a></span>&#160;  <a class="code" href="classTangram_1_1MatPoly.html#acc2a5d89ddc811f6acb3ef4d4780d753">MatPoly</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> material_id = -1) : material_id_(material_id) {}</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#acf9b8b3197a7b4dd7089042843020fa3">  133</a></span>&#160;  <a class="code" href="classTangram_1_1MatPoly.html#acf9b8b3197a7b4dd7089042843020fa3">~MatPoly</a>() {}</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#aac14f299f075ed1688c24103e1b268ac">  139</a></span>&#160;  <a class="code" href="classTangram_1_1MatPoly.html">MatPoly</a>&amp; <a class="code" href="classTangram_1_1MatPoly.html#aac14f299f075ed1688c24103e1b268ac">operator=</a>(<span class="keyword">const</span> <a class="code" href="classTangram_1_1MatPoly.html">MatPoly</a>&amp; source_poly) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    material_id_ = source_poly.material_id_;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    vertex_points_ = source_poly.vertex_points_;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    face_vertices_ = source_poly.face_vertices_;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    nvertices_ = source_poly.nvertices_;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    nfaces_ = source_poly.nfaces_;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    moments_ = source_poly.moments_;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  </div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#ace8b5fde89a513f0e9467f3ce8796e50">  152</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classTangram_1_1MatPoly.html#ace8b5fde89a513f0e9467f3ce8796e50">mat_id</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> material_id_; }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a4de137538d76c83a6b56f71e6ac7a602">  158</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a4de137538d76c83a6b56f71e6ac7a602">set_mat_id</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> <a class="code" href="classTangram_1_1MatPoly.html#ace8b5fde89a513f0e9467f3ce8796e50">mat_id</a>) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    assert(mat_id &gt;= 0);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    material_id_ = <a class="code" href="classTangram_1_1MatPoly.html#ace8b5fde89a513f0e9467f3ce8796e50">mat_id</a>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  </div><div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a4ffd8855a46fd704ce7749d43f8ded4e">  168</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a4ffd8855a46fd704ce7749d43f8ded4e">reset_mat_id</a>() { material_id_ = -1; }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a860f132a1987d539089fc1c80c7404a7">  173</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a860f132a1987d539089fc1c80c7404a7">clear</a>() {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    material_id_ = -1;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    vertex_points_.clear();</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    face_vertices_.clear();</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    nvertices_ = 0;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    nfaces_ = 0;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    moments_.clear();    </div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a0fde16656a5d88e5d7574fcd67b3ebcb">initialize</a>(<span class="keyword">const</span> std::vector&lt;Point2&gt;&amp; poly_points);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a0fde16656a5d88e5d7574fcd67b3ebcb">initialize</a>(<span class="keyword">const</span> std::vector&lt;Point3&gt;&amp; vertex_points,</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::vector&lt;int&gt; &gt;&amp; <a class="code" href="classTangram_1_1MatPoly.html#affd023482f50eeae0d97c7fa6697e358">face_vertices</a>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  </div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#aa756cca3df1a498d170bc3a86e6bae7b">  201</a></span>&#160;  <span class="keyword">const</span> std::vector&lt; Point&lt;D&gt; &gt;&amp; <a class="code" href="classTangram_1_1MatPoly.html#aa756cca3df1a498d170bc3a86e6bae7b">points</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> vertex_points_; }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#aab5cfa3fff9b96d2cbf96415fe7704af">  208</a></span>&#160;  <span class="keyword">const</span> std::vector&lt;int&gt;&amp; <a class="code" href="classTangram_1_1MatPoly.html#aab5cfa3fff9b96d2cbf96415fe7704af">face_vertices</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> face_id)<span class="keyword"> const </span>{</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    assert((face_id &gt;= 0) &amp;&amp; (face_id &lt; nfaces_));</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">return</span> face_vertices_[face_id];</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  </div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a5d4e12c797bbbaae17e97908cecd5b24">  220</a></span>&#160;  std::vector&lt; Point&lt;D&gt; &gt; <a class="code" href="classTangram_1_1MatPoly.html#a5d4e12c797bbbaae17e97908cecd5b24">face_points</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> face_id)<span class="keyword"> const </span>{</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    assert((face_id &gt;= 0) &amp;&amp; (face_id &lt; nfaces_));</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">int</span> nvrts = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(face_vertices_[face_id].size());</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    std::vector&lt; Point&lt;D&gt; &gt; fpoints;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    fpoints.reserve(nvrts);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; nvrts; ivrt++)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      fpoints.push_back(vertex_points_[face_vertices_[face_id][ivrt]]);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span> fpoints;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#affd023482f50eeae0d97c7fa6697e358">  237</a></span>&#160;  <span class="keyword">const</span> std::vector&lt;std::vector&lt;int&gt;&gt;&amp; <a class="code" href="classTangram_1_1MatPoly.html#affd023482f50eeae0d97c7fa6697e358">face_vertices</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">return</span> face_vertices_;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  </div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#ac6c290557b576c6aad5051d57a5b5685">  246</a></span>&#160;  <a class="code" href="classTangram_1_1Point.html">Point&lt;D&gt;</a> <a class="code" href="classTangram_1_1MatPoly.html#ac6c290557b576c6aad5051d57a5b5685">vertex_point</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> vertex_id)<span class="keyword"> const </span>{</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    assert((vertex_id &gt;= 0) &amp;&amp; (vertex_id &lt; nvertices_));</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">return</span> vertex_points_[vertex_id];</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  </div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="classTangram_1_1Point.html">Point&lt;D&gt;</a> <a class="code" href="classTangram_1_1MatPoly.html#ab6cf600e68b2ac811f7d53abff3c741f">face_centroid</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> face_id) <span class="keyword">const</span>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  </div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#aa5681ccd23930482bb6b3c243fb4425c">faceted_matpoly</a>(<a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;2&gt;</a>* faceted_poly) <span class="keyword">const</span>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#aa5681ccd23930482bb6b3c243fb4425c">faceted_matpoly</a>(<a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;3&gt;</a>* faceted_poly) <span class="keyword">const</span>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  </div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#aa32646522284f28e04aad59e815542f1">  278</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classTangram_1_1MatPoly.html#aa32646522284f28e04aad59e815542f1">num_vertices</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> nvertices_; }</div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a82d4a7bb4295c65916aaec1cc03b9a00">  283</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classTangram_1_1MatPoly.html#a82d4a7bb4295c65916aaec1cc03b9a00">num_faces</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> nfaces_; }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a957d9a56af044a7ca917817467298d07">  291</a></span>&#160;  <span class="keyword">const</span> std::vector&lt;double&gt;&amp; <a class="code" href="classTangram_1_1MatPoly.html#a957d9a56af044a7ca917817467298d07">moments</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (moments_.empty())</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <a class="code" href="classTangram_1_1MatPoly.html#a1eefd7af6205b972c3a5821d846618c8">compute_moments</a>(moments_);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">return</span> moments_;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  </div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#abaf29e137ee4fa958dccc7fa7e7ea785">  304</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#abaf29e137ee4fa958dccc7fa7e7ea785">assign_moments</a>(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; <a class="code" href="classTangram_1_1MatPoly.html#a957d9a56af044a7ca917817467298d07">moments</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    assert(moments.size() == D + 1);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor">#endif    </span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    moments_ = <a class="code" href="classTangram_1_1MatPoly.html#a957d9a56af044a7ca917817467298d07">moments</a>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a3a65db5622231e4086244ad25ab6288d">decompose</a>(<a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;D&gt;</a> &gt;&amp; sub_polys) <span class="keyword">const</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a8e814a40956aee6c5ade0c20abefe920">facetize_decompose</a>(<a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;D&gt;</a> &gt;&amp; sub_polys) <span class="keyword">const</span>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#aba885f75525c109661a08cb41a413a5b">face_planes</a>(<a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="structTangram_1_1Plane__t.html">Plane_t&lt;D&gt;</a> &gt;&amp; fplanes) <span class="keyword">const</span>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#aff224788989415116c567aabc00f578b">  339</a></span>&#160;  <a class="code" href="structTangram_1_1BoundingBox__t.html">BoundingBox_t&lt;D&gt;</a> <a class="code" href="classTangram_1_1MatPoly.html#aff224788989415116c567aabc00f578b">bounding_box</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="structTangram_1_1BoundingBox__t.html">BoundingBox_t&lt;D&gt;</a> bbox;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; nvertices_; ivrt++)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; D; idim++) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">if</span> (vertex_points_[ivrt][idim] &lt; bbox.<a class="code" href="structTangram_1_1BoundingBox__t.html#ab255aa2370f495b3c8b00f2a92ea72b0">min</a>[idim])</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          bbox.<a class="code" href="structTangram_1_1BoundingBox__t.html#ab255aa2370f495b3c8b00f2a92ea72b0">min</a>[idim] = vertex_points_[ivrt][idim];</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">if</span> (vertex_points_[ivrt][idim] &gt; bbox.<a class="code" href="structTangram_1_1BoundingBox__t.html#ad4ae706e0bc47e7416cfb1dc2d12d3db">max</a>[idim])</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          bbox.<a class="code" href="structTangram_1_1BoundingBox__t.html#ad4ae706e0bc47e7416cfb1dc2d12d3db">max</a>[idim] = vertex_points_[ivrt][idim];        </div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">return</span> bbox;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a1eefd7af6205b972c3a5821d846618c8">compute_moments</a>(std::vector&lt;double&gt;&amp; <a class="code" href="classTangram_1_1MatPoly.html#a957d9a56af044a7ca917817467298d07">moments</a>) <span class="keyword">const</span>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">int</span> material_id_;  <span class="comment">// material ID of this matpoly</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  std::vector&lt; Point&lt;D&gt; &gt; vertex_points_;  <span class="comment">// coordinates of vertices</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  std::vector&lt; std::vector&lt;int&gt; &gt; face_vertices_;  <span class="comment">// vertices of faces</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  </div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordtype">int</span> nvertices_ = 0;  <span class="comment">// number of vertices</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordtype">int</span> nfaces_ = 0;  <span class="comment">//number of faces</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keyword">mutable</span> std::vector&lt;double&gt; moments_; <span class="comment">//moments of this matpoly</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;};  <span class="comment">// class MatPoly</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keyword">template</span>&lt;&gt;</div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a0a96e1e58356a2fc9ddc311d041b99e0">  376</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a0fde16656a5d88e5d7574fcd67b3ebcb">MatPoly&lt;2&gt;::initialize</a>(<span class="keyword">const</span> std::vector&lt;Point2&gt;&amp; poly_points) {</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  nvertices_ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(poly_points.size());</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  assert(nvertices_ &gt; 2);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  nfaces_ = nvertices_;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  vertex_points_ = poly_points;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  face_vertices_.resize(nfaces_);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface = 0; iface &lt; nfaces_; iface++)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    face_vertices_[iface] = { iface, (iface + 1)%nfaces_ };</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keyword">template</span>&lt;&gt;</div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#ad49e58a6498dd66b410e0ddeee0e92ad">  396</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a0fde16656a5d88e5d7574fcd67b3ebcb">MatPoly&lt;3&gt;::initialize</a>(<span class="keyword">const</span> std::vector&lt;Point3&gt;&amp; vertex_points,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                            <span class="keyword">const</span> <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::vector&lt;int&gt; &gt;&amp; <a class="code" href="classTangram_1_1MatPoly.html#affd023482f50eeae0d97c7fa6697e358">face_vertices</a>) {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  nvertices_ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(vertex_points.size());</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  nfaces_ = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classTangram_1_1MatPoly.html#affd023482f50eeae0d97c7fa6697e358">face_vertices</a>.size());</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  assert(nvertices_ &gt; 3);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  assert(nfaces_ &gt; 3);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  </div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  vertex_points_ = vertex_points;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  face_vertices_ = <a class="code" href="classTangram_1_1MatPoly.html#affd023482f50eeae0d97c7fa6697e358">face_vertices</a>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keyword">template</span>&lt;&gt;  </div><div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#af4f47fcc06132bad3521868453cf1a2d">  415</a></span>&#160;<a class="code" href="classTangram_1_1Point.html">Point2</a> <a class="code" href="classTangram_1_1MatPoly.html#ab6cf600e68b2ac811f7d53abff3c741f">MatPoly&lt;2&gt;::face_centroid</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> face_id)<span class="keyword"> const </span>{</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  assert((face_id &gt;= 0) &amp;&amp; (face_id &lt; nfaces_));</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordflow">return</span> 0.5*(vertex_points_[face_id] + vertex_points_[(face_id + 1)%nvertices_]);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keyword">template</span>&lt;&gt;  </div><div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a3e294fac6eb0f5ae91d1a2cd30840c53">  428</a></span>&#160;<a class="code" href="classTangram_1_1Point.html">Point3</a> <a class="code" href="classTangram_1_1MatPoly.html#ab6cf600e68b2ac811f7d53abff3c741f">MatPoly&lt;3&gt;::face_centroid</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> face_id)<span class="keyword"> const </span>{</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  assert((face_id &gt;= 0) &amp;&amp; (face_id &lt; nfaces_));</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  std::vector&lt;double&gt; face_moments;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="namespaceTangram.html#addba9ffa7e87ee10c307576b5cfbc2ae">polygon3d_moments</a>(vertex_points_, face_vertices_[face_id], face_moments);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordflow">if</span> (std::fabs(face_moments[0]) &gt; std::numeric_limits&lt;double&gt;::epsilon())</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceTangram.html#a0d7f6faf100a226eee664d64ef9f725a">Point3</a>(face_moments[1]/face_moments[0], face_moments[2]/face_moments[0],</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                  face_moments[3]/face_moments[0]);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordtype">int</span> nvrts = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(face_vertices_[face_id].size());</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="classTangram_1_1Point.html">Point3</a> gcenter;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; nvrts; ivrt++)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      gcenter += vertex_points_[face_vertices_[face_id][ivrt]];</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    gcenter /= nvrts;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">return</span> gcenter;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;}</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keyword">template</span>&lt;&gt;</div><div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a3b43487edeeeb1e8af3bb751a0c15a90">  455</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#aa5681ccd23930482bb6b3c243fb4425c">MatPoly&lt;2&gt;::faceted_matpoly</a>(<a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;2&gt;</a>* faceted_poly)<span class="keyword"> const </span>{</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  *faceted_poly = *<span class="keyword">this</span>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keyword">template</span>&lt;&gt;</div><div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a9f3a511d6558db3f43f32d00511ed3e6">  466</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#aa5681ccd23930482bb6b3c243fb4425c">MatPoly&lt;3&gt;::faceted_matpoly</a>(<a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;3&gt;</a>* faceted_poly)<span class="keyword"> const </span>{</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">if</span> (material_id_ &gt;= 0)</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    faceted_poly-&gt;<a class="code" href="classTangram_1_1MatPoly.html#a4de137538d76c83a6b56f71e6ac7a602">set_mat_id</a>(material_id_);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    faceted_poly-&gt;<a class="code" href="classTangram_1_1MatPoly.html#a4ffd8855a46fd704ce7749d43f8ded4e">reset_mat_id</a>();</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  std::vector&lt;Point3&gt; facetedpoly_vertices = vertex_points_;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  std::vector&lt; std::vector&lt;int&gt; &gt; facetedpoly_faces_;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  facetedpoly_faces_.reserve(nfaces_);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface = 0; iface &lt; nfaces_; iface++) {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">int</span> nvrts = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(face_vertices_[iface].size());</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> (nvrts == 3) {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      facetedpoly_faces_.push_back(face_vertices_[iface]);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">int</span> icenvrt = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(facetedpoly_vertices.size());</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    facetedpoly_vertices.push_back(<a class="code" href="classTangram_1_1MatPoly.html#ab6cf600e68b2ac811f7d53abff3c741f">face_centroid</a>(iface));</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; nvrts; ivrt++)</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      facetedpoly_faces_.push_back({ icenvrt, face_vertices_[iface][ivrt],</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                     face_vertices_[iface][(ivrt + 1)%nvrts] });</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  </div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  faceted_poly-&gt;<a class="code" href="classTangram_1_1MatPoly.html#a0fde16656a5d88e5d7574fcd67b3ebcb">initialize</a>(facetedpoly_vertices, facetedpoly_faces_);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">if</span> (!moments_.empty())</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    faceted_poly-&gt;<a class="code" href="classTangram_1_1MatPoly.html#abaf29e137ee4fa958dccc7fa7e7ea785">assign_moments</a>(moments_);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;}</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keyword">template</span>&lt;&gt;</div><div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a15c10f97eed244f38129f07ea32a0f3d">  499</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a1eefd7af6205b972c3a5821d846618c8">MatPoly&lt;2&gt;::compute_moments</a>(std::vector&lt;double&gt;&amp; <a class="code" href="classTangram_1_1MatPoly.html#a957d9a56af044a7ca917817467298d07">moments</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  moments.assign(3, 0.0);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; nvertices_; ivrt++) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">double</span> cur_term = vertex_points_[ivrt][0]*vertex_points_[(ivrt + 1)%nvertices_][1] - </div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                      vertex_points_[ivrt][1]*vertex_points_[(ivrt + 1)%nvertices_][0];</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    moments[0] += cur_term;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; 2; idim++)</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      moments[idim + 1] += cur_term*(</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        vertex_points_[ivrt][idim] + vertex_points_[(ivrt + 1)%nvertices_][idim]);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  moments[0] /= 2.0;  </div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; 2; idim++)</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    moments[idim + 1] /= 6.0;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="keyword">template</span>&lt;&gt;</div><div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a116dfc13f6bb75fc9e22ddde18552b46">  521</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a1eefd7af6205b972c3a5821d846618c8">MatPoly&lt;3&gt;::compute_moments</a>(std::vector&lt;double&gt;&amp; <a class="code" href="classTangram_1_1MatPoly.html#a957d9a56af044a7ca917817467298d07">moments</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  moments.assign(4, 0.0); </div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface = 0; iface &lt; nfaces_; iface++) {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    std::vector&lt;double&gt; face_moments;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="namespaceTangram.html#addba9ffa7e87ee10c307576b5cfbc2ae">polygon3d_moments</a>(vertex_points_, face_vertices_[iface], face_moments);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">if</span> (std::fabs(face_moments[0]) &lt;= std::numeric_limits&lt;double&gt;::epsilon())</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    std::vector&lt;Point3&gt; face_pts = <a class="code" href="classTangram_1_1MatPoly.html#a5d4e12c797bbbaae17e97908cecd5b24">face_points</a>(iface);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    std::vector&lt; std::vector&lt;int&gt; &gt; itri_pts;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    </div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordtype">int</span> nvrts = face_vertices_[iface].size();</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">if</span> (nvrts == 3)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      itri_pts.push_back({0, 1, 2});</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      itri_pts.reserve(nvrts);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      face_pts.push_back(<a class="code" href="namespaceTangram.html#a0d7f6faf100a226eee664d64ef9f725a">Point3</a>(face_moments[1]/face_moments[0],</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        face_moments[2]/face_moments[0], face_moments[3]/face_moments[0]));</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; nvrts; ivrt++)</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        itri_pts.push_back({nvrts, ivrt, (ivrt + 1)%nvrts});</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itri = 0; itri &lt; itri_pts.size(); itri++) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <a class="code" href="classTangram_1_1Vector.html">Vector3</a> vcp = <a class="code" href="namespaceTangram.html#a84b9705686c77f9e2022cf7cffb8435c">cross</a>(face_pts[itri_pts[itri][1]] - face_pts[itri_pts[itri][0]], </div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                          face_pts[itri_pts[itri][2]] - face_pts[itri_pts[itri][0]]);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keywordflow">if</span> (vcp.<a class="code" href="classTangram_1_1Vector.html#adaf9a2f1b36d0713d2ae772e5ecd3103">norm</a>() &lt;= std::numeric_limits&lt;double&gt;::epsilon())</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      moments[0] += <a class="code" href="namespaceTangram.html#a3f3b5ab00373f6e544350802fc83ba88">dot</a>(vcp, face_pts[itri_pts[itri][0]].asV());</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; 3; idim++)</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; 3; ivrt++)</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;          moments[idim + 1] += vcp[idim]*pow(face_pts[itri_pts[itri][ivrt]][idim] + </div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                             face_pts[itri_pts[itri][(ivrt + 1)%3]][idim], 2);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  moments[0] /= 6.0;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; 3; idim++)</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    moments[idim + 1] /= 48.0;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00571"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#ae7e827f101bd68b9c8643bc0e4276ba2">  571</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a3a65db5622231e4086244ad25ab6288d">MatPoly&lt;2&gt;::decompose</a>(<a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;2&gt;</a> &gt;&amp; sub_polys)<span class="keyword"> const </span>{</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  std::vector&lt;double&gt; <a class="code" href="classTangram_1_1MatPoly.html#a957d9a56af044a7ca917817467298d07">moments</a>;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordflow">if</span> (moments_.empty()) </div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="classTangram_1_1MatPoly.html#a1eefd7af6205b972c3a5821d846618c8">compute_moments</a>(moments_);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <a class="code" href="classTangram_1_1Point.html">Point2</a> matpoly_cen;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ixy = 0; ixy &lt; 2; ixy++)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    matpoly_cen[ixy] = moments_[ixy + 1]/moments_[0];</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="keywordtype">int</span> offset = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(sub_polys.size());</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  sub_polys.resize(offset + nfaces_);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface = 0; iface &lt; nfaces_; iface++) {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    std::vector&lt;Point2&gt; subpoly_points = <a class="code" href="classTangram_1_1MatPoly.html#a5d4e12c797bbbaae17e97908cecd5b24">face_points</a>(iface);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    subpoly_points.push_back(matpoly_cen);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    sub_polys[offset + iface].initialize(subpoly_points);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;}</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#aeb217fbc478559061f1d9a15302754fe">  598</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a3a65db5622231e4086244ad25ab6288d">MatPoly&lt;3&gt;::decompose</a>(<a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;3&gt;</a> &gt;&amp; sub_polys)<span class="keyword"> const </span>{</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordflow">if</span> (moments_.empty()) </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="classTangram_1_1MatPoly.html#a1eefd7af6205b972c3a5821d846618c8">compute_moments</a>(moments_);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="classTangram_1_1Point.html">Point3</a> matpoly_cen;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ixyz = 0; ixyz &lt; 3; ixyz++)</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    matpoly_cen[ixyz] = moments_[ixyz + 1]/moments_[0];</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordtype">int</span> offset = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(sub_polys.size());</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  sub_polys.resize(offset + nfaces_);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface = 0; iface &lt; nfaces_; iface++) {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordtype">int</span> face_nvrts = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(face_vertices_[iface].size());</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    std::vector&lt;Point3&gt; subpoly_vrts(face_nvrts + 1);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    std::vector&lt; std::vector&lt;int&gt; &gt; subpoly_faces(face_nvrts + 1);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; face_nvrts; ivrt++) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      subpoly_vrts[ivrt] = vertex_points_[face_vertices_[iface][ivrt]];</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      subpoly_faces[ivrt] = {face_nvrts, (ivrt + 1)%face_nvrts, ivrt};</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    subpoly_vrts[face_nvrts] = matpoly_cen;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    subpoly_faces[face_nvrts].resize(face_nvrts);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    std::iota(subpoly_faces[face_nvrts].begin(), </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;              subpoly_faces[face_nvrts].end(), 0);      </div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    </div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    sub_polys[offset + iface].initialize(subpoly_vrts, subpoly_faces);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;}</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00635"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a83ef428cceacc7a027e4d0f6318083be">  635</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a8e814a40956aee6c5ade0c20abefe920">MatPoly&lt;2&gt;::facetize_decompose</a>(<a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;2&gt;</a> &gt;&amp; sub_polys)<span class="keyword"> const </span>{</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <a class="code" href="classTangram_1_1MatPoly.html#a3a65db5622231e4086244ad25ab6288d">decompose</a>(sub_polys);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00647"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#aaf06a4d1872ec40eadeaa264a5b75db7">  647</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#a8e814a40956aee6c5ade0c20abefe920">MatPoly&lt;3&gt;::facetize_decompose</a>(<a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;3&gt;</a> &gt;&amp; sub_polys)<span class="keyword"> const </span>{</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  std::vector&lt; std::vector&lt;int&gt; &gt; tet_faces(4);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; 3; ivrt++)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    tet_faces[ivrt] = {3, (ivrt + 1)%3, ivrt};</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  tet_faces[3] = {0, 1, 2};  </div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">if</span> (moments_.empty()) </div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="classTangram_1_1MatPoly.html#a1eefd7af6205b972c3a5821d846618c8">compute_moments</a>(moments_);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  std::vector&lt;Point3&gt; tet_vrts(4);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ixyz = 0; ixyz &lt; 3; ixyz++)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    tet_vrts[3][ixyz] = moments_[ixyz + 1]/moments_[0];</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface = 0; iface &lt; nfaces_; iface++) {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordtype">int</span> face_nvrts = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(face_vertices_[iface].size());</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">if</span> (face_nvrts == 3) {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; 3; ivrt++)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        tet_vrts[ivrt] = vertex_points_[face_vertices_[iface][ivrt]];</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="keywordtype">int</span> icur_poly = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(sub_polys.size());</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      sub_polys.push_back(<a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;3&gt;</a>(material_id_));</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      sub_polys[icur_poly].initialize(tet_vrts, tet_faces);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    }</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      tet_vrts[0] = <a class="code" href="classTangram_1_1MatPoly.html#ab6cf600e68b2ac811f7d53abff3c741f">face_centroid</a>(iface);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; face_nvrts; ivrt++) {</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        tet_vrts[1] = vertex_points_[face_vertices_[iface][ivrt]];</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        tet_vrts[2] = vertex_points_[face_vertices_[iface][(ivrt + 1)%face_nvrts]];</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordtype">int</span> icur_poly = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(sub_polys.size());</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        sub_polys.push_back(<a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;3&gt;</a>(material_id_));</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        sub_polys[icur_poly].initialize(tet_vrts, tet_faces);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  }</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;}</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Mesh_Wrapper&gt;</div><div class="line"><a name="l00684"></a><span class="lineno"><a class="line" href="namespaceTangram.html#a56993fc630a4a4f0e007615959915181">  684</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTangram.html#a56993fc630a4a4f0e007615959915181">cell_get_matpoly</a>(<span class="keyword">const</span> Mesh_Wrapper&amp; Mesh,</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                      <span class="keywordtype">int</span> <span class="keyword">const</span> cellid,</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                      <a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;2&gt;</a>* mat_poly) {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="preprocessor">#ifdef DEBUG                        </span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  assert(Mesh.space_dimension() == 2);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  mat_poly-&gt;<a class="code" href="classTangram_1_1MatPoly.html#a4ffd8855a46fd704ce7749d43f8ded4e">reset_mat_id</a>();</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  std::vector&lt;Point2&gt; poly_points;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  Mesh.cell_get_coordinates(cellid, &amp;poly_points);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  mat_poly-&gt;<a class="code" href="classTangram_1_1MatPoly.html#a0fde16656a5d88e5d7574fcd67b3ebcb">initialize</a>(poly_points);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;}</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Mesh_Wrapper&gt;</div><div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="namespaceTangram.html#a3c6ee97014f69104b4fb5396419174fe">  699</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTangram.html#a56993fc630a4a4f0e007615959915181">cell_get_matpoly</a>(<span class="keyword">const</span> Mesh_Wrapper&amp; Mesh,</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                      <span class="keywordtype">int</span> <span class="keyword">const</span> cellid,</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                      <a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;3&gt;</a>* mat_poly) {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="preprocessor">#ifdef DEBUG                        </span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  assert(Mesh.space_dimension() == 3);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  mat_poly-&gt;<a class="code" href="classTangram_1_1MatPoly.html#a4ffd8855a46fd704ce7749d43f8ded4e">reset_mat_id</a>();</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  std::vector&lt;Point3&gt; poly_points;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  std::vector&lt; std::vector&lt;int&gt; &gt; poly_faces;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  std::vector&lt;int&gt; cnodes;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  Mesh.cell_get_nodes(cellid, &amp;cnodes);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordtype">int</span> ncnodes = cnodes.size();</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  poly_points.resize(ncnodes);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; ncnodes; ++n)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    Mesh.node_get_coordinates(cnodes[n], &amp;poly_points[n]);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  std::vector&lt;int&gt; cfaces, cfdirs;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  Mesh.cell_get_faces_and_dirs(cellid, &amp;cfaces, &amp;cfdirs);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordtype">int</span> ncfaces = cfaces.size();</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; ncfaces; f++) {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    std::vector&lt;int&gt; fnodes;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    Mesh.face_get_nodes(cfaces[f], &amp;fnodes);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordtype">int</span> nfnodes = fnodes.size();</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">//Check that the order of nodes is ccw</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">if</span> (cfdirs[f] != 1)</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      std::reverse(fnodes.begin(), fnodes.end());</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">// Get the local indices (in the cell node list) of the face nodes</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    std::vector&lt;int&gt; fnodes_local(nfnodes);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nfnodes; n++) {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      fnodes_local[n] = std::distance(cnodes.begin(),</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        std::find(cnodes.begin(), cnodes.end(), fnodes[n]));</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      assert(fnodes_local[n] != ncnodes);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    poly_faces.emplace_back(fnodes_local);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  mat_poly-&gt;<a class="code" href="classTangram_1_1MatPoly.html#a0fde16656a5d88e5d7574fcd67b3ebcb">initialize</a>(poly_points, poly_faces);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;}</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00751"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#af3b7e4023fdf489773ca52943d41006f">  751</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#aba885f75525c109661a08cb41a413a5b">MatPoly&lt;2&gt;::face_planes</a>(<a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="structTangram_1_1Plane__t.html">Plane_t&lt;2&gt;</a> &gt;&amp; flines)<span class="keyword"> const </span>{</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  flines.clear();</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface = 0; iface &lt; nfaces_; iface++) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="structTangram_1_1Plane__t.html">Plane_t&lt;2&gt;</a> face_line;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    face_line.<a class="code" href="structTangram_1_1Plane__t.html#aeb5db1642a6d790563f1ae78154de428">normal</a>[0] = vertex_points_[face_vertices_[iface][1]][1] - </div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                          vertex_points_[face_vertices_[iface][0]][1];</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    face_line.<a class="code" href="structTangram_1_1Plane__t.html#aeb5db1642a6d790563f1ae78154de428">normal</a>[1] = -(vertex_points_[face_vertices_[iface][1]][0] - </div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                            vertex_points_[face_vertices_[iface][0]][0]);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordtype">double</span> normal_len = face_line.<a class="code" href="structTangram_1_1Plane__t.html#aeb5db1642a6d790563f1ae78154de428">normal</a>.norm();</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span> (normal_len &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      face_line.<a class="code" href="structTangram_1_1Plane__t.html#aeb5db1642a6d790563f1ae78154de428">normal</a> /= normal_len;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      face_line.<a class="code" href="structTangram_1_1Plane__t.html#a0de6ac6eb2b34ebc3d70ced8df621ce5">dist2origin</a> = </div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        -<a class="code" href="namespaceTangram.html#a3f3b5ab00373f6e544350802fc83ba88">dot</a>(vertex_points_[face_vertices_[iface][0]].asV(), face_line.<a class="code" href="structTangram_1_1Plane__t.html#aeb5db1642a6d790563f1ae78154de428">normal</a>);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      flines.push_back(face_line); </div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="keywordflow">if</span> (flines.size() &lt; 3)</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    flines.clear();</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;}</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="keyword">template</span> &lt;&gt;</div><div class="line"><a name="l00784"></a><span class="lineno"><a class="line" href="classTangram_1_1MatPoly.html#a3139b7f9d551301f2c70240eb460fa7b">  784</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTangram_1_1MatPoly.html#aba885f75525c109661a08cb41a413a5b">MatPoly&lt;3&gt;::face_planes</a>(<a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="structTangram_1_1Plane__t.html">Plane_t&lt;3&gt;</a> &gt;&amp; fplanes)<span class="keyword"> const </span>{</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  fplanes.clear();</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface = 0; iface &lt; nfaces_; iface++) {</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <a class="code" href="structTangram_1_1Plane__t.html">Plane_t&lt;3&gt;</a> face_plane;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    face_plane.<a class="code" href="structTangram_1_1Plane__t.html#aeb5db1642a6d790563f1ae78154de428">normal</a> = <a class="code" href="namespaceTangram.html#afddb4621ade732fd64b8523a9475054b">polygon3d_normal</a>(vertex_points_, </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                         face_vertices_[iface]);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">if</span> (face_plane.<a class="code" href="structTangram_1_1Plane__t.html#aeb5db1642a6d790563f1ae78154de428">normal</a>.is_zero())</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    </div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    face_plane.<a class="code" href="structTangram_1_1Plane__t.html#a0de6ac6eb2b34ebc3d70ced8df621ce5">dist2origin</a> = </div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      -<a class="code" href="namespaceTangram.html#a3f3b5ab00373f6e544350802fc83ba88">dot</a>(vertex_points_[face_vertices_[iface][0]].asV(), face_plane.<a class="code" href="structTangram_1_1Plane__t.html#aeb5db1642a6d790563f1ae78154de428">normal</a>);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    fplanes.push_back(face_plane);  </div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  }</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">if</span> (fplanes.size() &lt; 4)</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    fplanes.clear();</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;}</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno"><a class="line" href="namespaceTangram.html#a316439a55e37de20974405fc9729d16a">  813</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceTangram.html#a316439a55e37de20974405fc9729d16a">point_inside_matpoly</a>(<span class="keyword">const</span> <a class="code" href="classTangram_1_1MatPoly.html">MatPoly&lt;3&gt;</a> mat_poly,</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                          <span class="keyword">const</span> <a class="code" href="classTangram_1_1Point.html">Point&lt;3&gt;</a>&amp; pt, <span class="keywordtype">bool</span> convex_poly=<span class="keyword">false</span>) {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  std::vector&lt; MatPoly&lt;3&gt; &gt; convex_polys;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="keywordflow">if</span> (convex_poly)</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    convex_polys.push_back(mat_poly);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordflow">else</span> </div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    mat_poly.<a class="code" href="classTangram_1_1MatPoly.html#a8e814a40956aee6c5ade0c20abefe920">facetize_decompose</a>(convex_polys);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icp = 0; icp &lt; convex_polys.size(); icp++) {</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keyword">const</span> std::vector&lt; Point&lt;3&gt; &gt;&amp; poly_pts = convex_polys[icp].points();</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordtype">bool</span> pt_inside_cur_poly = <span class="keyword">true</span>;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface = 0; iface &lt; convex_polys[icp].num_faces(); iface++) {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keyword">const</span> std::vector&lt;int&gt;&amp; iface_vrts = convex_polys[icp].face_vertices(iface);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <a class="code" href="classTangram_1_1Vector.html">Vector3</a> pt2vrt_vec;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordtype">double</span> pt2vrt_dst = 0.0;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">//Find a face vertex that is the farthest from the given point</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ifvrt = 0; ifvrt &lt; iface_vrts.size(); ifvrt++) {</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <a class="code" href="classTangram_1_1Vector.html">Vector3</a> cur_pt2vrt_vec = </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;          convex_polys[icp].vertex_point(iface_vrts[ifvrt]) - pt;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordtype">double</span> cur_vec_norm = cur_pt2vrt_vec.<a class="code" href="classTangram_1_1Vector.html#adaf9a2f1b36d0713d2ae772e5ecd3103">norm</a>();</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="keywordflow">if</span> (cur_vec_norm &gt; pt2vrt_dst) {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          pt2vrt_vec = cur_pt2vrt_vec;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          pt2vrt_dst = cur_vec_norm;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        }</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      pt2vrt_vec /= pt2vrt_dst;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <a class="code" href="classTangram_1_1Vector.html">Vector3</a> face_normal = <a class="code" href="namespaceTangram.html#afddb4621ade732fd64b8523a9475054b">polygon3d_normal</a>(poly_pts, iface_vrts);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keywordflow">if</span> (face_normal.<a class="code" href="classTangram_1_1Vector.html#a18e2941185b8227b1bcb1f460abb12bb">is_zero</a>())</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keywordtype">double</span> fnormal_prj = <a class="code" href="namespaceTangram.html#a3f3b5ab00373f6e544350802fc83ba88">dot</a>(pt2vrt_vec, face_normal);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="comment">//Check the sign of the projection onto the normal</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keywordflow">if</span> (fnormal_prj &lt;= std::numeric_limits&lt;double&gt;::epsilon()) {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        pt_inside_cur_poly = <span class="keyword">false</span>;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    }  </div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">if</span> (pt_inside_cur_poly)</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;}</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;}  <span class="comment">// namespace Tangram</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="preprocessor">#endif  // TANGRAM_MATPOLY_H_</span></div><div class="ttc" id="classTangram_1_1MatPoly_html_acc2a5d89ddc811f6acb3ef4d4780d753"><div class="ttname"><a href="classTangram_1_1MatPoly.html#acc2a5d89ddc811f6acb3ef4d4780d753">Tangram::MatPoly::MatPoly</a></div><div class="ttdeci">MatPoly(int const material_id=-1)</div><div class="ttdoc">Constructor, undefined material ID corresponds to -1 value. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:130</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_abaf29e137ee4fa958dccc7fa7e7ea785"><div class="ttname"><a href="classTangram_1_1MatPoly.html#abaf29e137ee4fa958dccc7fa7e7ea785">Tangram::MatPoly::assign_moments</a></div><div class="ttdeci">void assign_moments(const std::vector&lt; double &gt; &amp;moments) const</div><div class="ttdoc">Assigns externally computed moments to this material poly. Can also be used to copy moments from the ...</div><div class="ttdef"><b>Definition:</b> MatPoly.h:304</div></div>
<div class="ttc" id="namespaceTangram_html_a0d7f6faf100a226eee664d64ef9f725a"><div class="ttname"><a href="namespaceTangram.html#a0d7f6faf100a226eee664d64ef9f725a">Tangram::Point3</a></div><div class="ttdeci">Point&lt; 3 &gt; Point3</div><div class="ttdoc">Alias for creating a Point in 3d. </div><div class="ttdef"><b>Definition:</b> Point.h:187</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_a3a65db5622231e4086244ad25ab6288d"><div class="ttname"><a href="classTangram_1_1MatPoly.html#a3a65db5622231e4086244ad25ab6288d">Tangram::MatPoly::decompose</a></div><div class="ttdeci">void decompose(std::vector&lt; MatPoly&lt; D &gt; &gt; &amp;sub_polys) const</div><div class="ttdoc">Decomposes this MatPoly into MatPoly&amp;#39;s using its centroid. If faces of MatPoly are planar...</div></div>
<div class="ttc" id="namespaceTangram_html_a56993fc630a4a4f0e007615959915181"><div class="ttname"><a href="namespaceTangram.html#a56993fc630a4a4f0e007615959915181">Tangram::cell_get_matpoly</a></div><div class="ttdeci">void cell_get_matpoly(const Mesh_Wrapper &amp;Mesh, int const cellid, MatPoly&lt; 2 &gt; *mat_poly)</div><div class="ttdef"><b>Definition:</b> MatPoly.h:684</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_a8e814a40956aee6c5ade0c20abefe920"><div class="ttname"><a href="classTangram_1_1MatPoly.html#a8e814a40956aee6c5ade0c20abefe920">Tangram::MatPoly::facetize_decompose</a></div><div class="ttdeci">void facetize_decompose(std::vector&lt; MatPoly&lt; D &gt; &gt; &amp;sub_polys) const</div><div class="ttdoc">Facetizes and decomposes this MatPoly into simplex MatPoly&amp;#39;s using its centroid. </div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_a5d4e12c797bbbaae17e97908cecd5b24"><div class="ttname"><a href="classTangram_1_1MatPoly.html#a5d4e12c797bbbaae17e97908cecd5b24">Tangram::MatPoly::face_points</a></div><div class="ttdeci">std::vector&lt; Point&lt; D &gt; &gt; face_points(int const face_id) const</div><div class="ttdoc">Coordinates of vertices of the material poly&amp;#39;s face. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:220</div></div>
<div class="ttc" id="classTangram_1_1Vector_html_a15d0c4cf8f5b7529f4e0895ab6e6c933"><div class="ttname"><a href="classTangram_1_1Vector.html#a15d0c4cf8f5b7529f4e0895ab6e6c933">Tangram::Vector::normalize</a></div><div class="ttdeci">void normalize()</div><div class="ttdoc">Convert this Vector into a unit Vector. </div><div class="ttdef"><b>Definition:</b> Vector.h:169</div></div>
<div class="ttc" id="namespaceTangram_html_a84b9705686c77f9e2022cf7cffb8435c"><div class="ttname"><a href="namespaceTangram.html#a84b9705686c77f9e2022cf7cffb8435c">Tangram::cross</a></div><div class="ttdeci">double cross(const Vector&lt; 2 &gt; &amp;a, const Vector&lt; 2 &gt; &amp;b)</div><div class="ttdoc">Cross product operator for two 2d vectors, . </div><div class="ttdef"><b>Definition:</b> Vector.h:279</div></div>
<div class="ttc" id="namespaceTangram_html_a316439a55e37de20974405fc9729d16a"><div class="ttname"><a href="namespaceTangram.html#a316439a55e37de20974405fc9729d16a">Tangram::point_inside_matpoly</a></div><div class="ttdeci">bool point_inside_matpoly(const MatPoly&lt; 3 &gt; mat_poly, const Point&lt; 3 &gt; &amp;pt, bool convex_poly=false)</div><div class="ttdoc">Checks if a given point is interior wrt to a given polyhedron. Note: boundary points are no considere...</div><div class="ttdef"><b>Definition:</b> MatPoly.h:813</div></div>
<div class="ttc" id="classTangram_1_1Vector_html"><div class="ttname"><a href="classTangram_1_1Vector.html">Tangram::Vector</a></div><div class="ttdoc">Represents a vector in N-dimensional space. </div><div class="ttdef"><b>Definition:</b> Vector.h:39</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_aa756cca3df1a498d170bc3a86e6bae7b"><div class="ttname"><a href="classTangram_1_1MatPoly.html#aa756cca3df1a498d170bc3a86e6bae7b">Tangram::MatPoly::points</a></div><div class="ttdeci">const std::vector&lt; Point&lt; D &gt; &gt; &amp; points() const</div><div class="ttdoc">Points for all the vertices of the material poly. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:201</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_a957d9a56af044a7ca917817467298d07"><div class="ttname"><a href="classTangram_1_1MatPoly.html#a957d9a56af044a7ca917817467298d07">Tangram::MatPoly::moments</a></div><div class="ttdeci">const std::vector&lt; double &gt; &amp; moments() const</div><div class="ttdoc">Moments of material poly, when the method is called for the first time, moments will be computed and ...</div><div class="ttdef"><b>Definition:</b> MatPoly.h:291</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_aab5cfa3fff9b96d2cbf96415fe7704af"><div class="ttname"><a href="classTangram_1_1MatPoly.html#aab5cfa3fff9b96d2cbf96415fe7704af">Tangram::MatPoly::face_vertices</a></div><div class="ttdeci">const std::vector&lt; int &gt; &amp; face_vertices(int const face_id) const</div><div class="ttdoc">Indices of vertices of the material poly&amp;#39;s face. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:208</div></div>
<div class="ttc" id="namespaceTangram_html_addba9ffa7e87ee10c307576b5cfbc2ae"><div class="ttname"><a href="namespaceTangram.html#addba9ffa7e87ee10c307576b5cfbc2ae">Tangram::polygon3d_moments</a></div><div class="ttdeci">void polygon3d_moments(const std::vector&lt; Point3 &gt; &amp;points, const std::vector&lt; int &gt; &amp;poly_vertices, std::vector&lt; double &gt; &amp;poly_moments)</div><div class="ttdef"><b>Definition:</b> MatPoly.h:53</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_a82d4a7bb4295c65916aaec1cc03b9a00"><div class="ttname"><a href="classTangram_1_1MatPoly.html#a82d4a7bb4295c65916aaec1cc03b9a00">Tangram::MatPoly::num_faces</a></div><div class="ttdeci">int num_faces() const</div><div class="ttdoc">Number of material poly&amp;#39;s faces. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:283</div></div>
<div class="ttc" id="classTangram_1_1Vector_html_adaf9a2f1b36d0713d2ae772e5ecd3103"><div class="ttname"><a href="classTangram_1_1Vector.html#adaf9a2f1b36d0713d2ae772e5ecd3103">Tangram::Vector::norm</a></div><div class="ttdeci">double norm(bool doSqrt=true) const</div><div class="ttdoc">Calculate the norm of a Vector. </div><div class="ttdef"><b>Definition:</b> Vector.h:139</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_aff224788989415116c567aabc00f578b"><div class="ttname"><a href="classTangram_1_1MatPoly.html#aff224788989415116c567aabc00f578b">Tangram::MatPoly::bounding_box</a></div><div class="ttdeci">BoundingBox_t&lt; D &gt; bounding_box() const</div><div class="ttdef"><b>Definition:</b> MatPoly.h:339</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html"><div class="ttname"><a href="classTangram_1_1MatPoly.html">Tangram::MatPoly</a></div><div class="ttdef"><b>Definition:</b> MatPoly.h:124</div></div>
<div class="ttc" id="namespaceTangram_html_afddb4621ade732fd64b8523a9475054b"><div class="ttname"><a href="namespaceTangram.html#afddb4621ade732fd64b8523a9475054b">Tangram::polygon3d_normal</a></div><div class="ttdeci">Vector&lt; 3 &gt; polygon3d_normal(const std::vector&lt; Point3 &gt; &amp;points, const std::vector&lt; int &gt; &amp;poly_vertices)</div><div class="ttdef"><b>Definition:</b> MatPoly.h:99</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_a4de137538d76c83a6b56f71e6ac7a602"><div class="ttname"><a href="classTangram_1_1MatPoly.html#a4de137538d76c83a6b56f71e6ac7a602">Tangram::MatPoly::set_mat_id</a></div><div class="ttdeci">void set_mat_id(int const mat_id)</div><div class="ttdoc">Set the ID of the material contained in this poly. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:158</div></div>
<div class="ttc" id="structTangram_1_1Plane__t_html_aeb5db1642a6d790563f1ae78154de428"><div class="ttname"><a href="structTangram_1_1Plane__t.html#aeb5db1642a6d790563f1ae78154de428">Tangram::Plane_t::normal</a></div><div class="ttdeci">Vector&lt; D &gt; normal</div><div class="ttdef"><b>Definition:</b> tangram.h:173</div></div>
<div class="ttc" id="classTangram_1_1Point_html"><div class="ttname"><a href="classTangram_1_1Point.html">Tangram::Point</a></div><div class="ttdoc">Represents a point in an N-dimensional space. </div><div class="ttdef"><b>Definition:</b> Point.h:48</div></div>
<div class="ttc" id="namespaceTangram_html"><div class="ttname"><a href="namespaceTangram.html">Tangram</a></div><div class="ttdef"><b>Definition:</b> CellMatPoly.h:18</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_a1eefd7af6205b972c3a5821d846618c8"><div class="ttname"><a href="classTangram_1_1MatPoly.html#a1eefd7af6205b972c3a5821d846618c8">Tangram::MatPoly::compute_moments</a></div><div class="ttdeci">void compute_moments(std::vector&lt; double &gt; &amp;moments) const</div><div class="ttdoc">Computes moments of this material poly. </div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_ab6cf600e68b2ac811f7d53abff3c741f"><div class="ttname"><a href="classTangram_1_1MatPoly.html#ab6cf600e68b2ac811f7d53abff3c741f">Tangram::MatPoly::face_centroid</a></div><div class="ttdeci">Point&lt; D &gt; face_centroid(int const face_id) const</div><div class="ttdoc">Coordinates of the centroid of the material poly&amp;#39;s face. </div></div>
<div class="ttc" id="structTangram_1_1BoundingBox__t_html"><div class="ttname"><a href="structTangram_1_1BoundingBox__t.html">Tangram::BoundingBox_t</a></div><div class="ttdef"><b>Definition:</b> tangram.h:227</div></div>
<div class="ttc" id="tangram_8h_html"><div class="ttname"><a href="tangram_8h.html">tangram.h</a></div></div>
<div class="ttc" id="structTangram_1_1Plane__t_html_a0de6ac6eb2b34ebc3d70ced8df621ce5"><div class="ttname"><a href="structTangram_1_1Plane__t.html#a0de6ac6eb2b34ebc3d70ced8df621ce5">Tangram::Plane_t::dist2origin</a></div><div class="ttdeci">double dist2origin</div><div class="ttdef"><b>Definition:</b> tangram.h:174</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_a860f132a1987d539089fc1c80c7404a7"><div class="ttname"><a href="classTangram_1_1MatPoly.html#a860f132a1987d539089fc1c80c7404a7">Tangram::MatPoly::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Resets the MatPoly data. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:173</div></div>
<div class="ttc" id="structTangram_1_1Plane__t_html"><div class="ttname"><a href="structTangram_1_1Plane__t.html">Tangram::Plane_t</a></div><div class="ttdef"><b>Definition:</b> tangram.h:172</div></div>
<div class="ttc" id="namespaceTangram_html_a3f3b5ab00373f6e544350802fc83ba88"><div class="ttname"><a href="namespaceTangram.html#a3f3b5ab00373f6e544350802fc83ba88">Tangram::dot</a></div><div class="ttdeci">double dot(const Vector&lt; D &gt; &amp;a, const Vector&lt; D &gt; &amp;b)</div><div class="ttdoc">Dot product of two vectors, . </div><div class="ttdef"><b>Definition:</b> Vector.h:223</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_ace8b5fde89a513f0e9467f3ce8796e50"><div class="ttname"><a href="classTangram_1_1MatPoly.html#ace8b5fde89a513f0e9467f3ce8796e50">Tangram::MatPoly::mat_id</a></div><div class="ttdeci">int mat_id() const</div><div class="ttdoc">ID of the material this poly contains. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:152</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_aa5681ccd23930482bb6b3c243fb4425c"><div class="ttname"><a href="classTangram_1_1MatPoly.html#aa5681ccd23930482bb6b3c243fb4425c">Tangram::MatPoly::faceted_matpoly</a></div><div class="ttdeci">void faceted_matpoly(MatPoly&lt; 2 &gt; *faceted_poly) const</div><div class="ttdoc">Facetization of the 2D polygon&amp;#39;s boundary: simply creates a copy of the polygon. </div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_ac6c290557b576c6aad5051d57a5b5685"><div class="ttname"><a href="classTangram_1_1MatPoly.html#ac6c290557b576c6aad5051d57a5b5685">Tangram::MatPoly::vertex_point</a></div><div class="ttdeci">Point&lt; D &gt; vertex_point(int const vertex_id) const</div><div class="ttdoc">Coordinates of the material poly&amp;#39;s vertex. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:246</div></div>
<div class="ttc" id="structTangram_1_1BoundingBox__t_html_ad4ae706e0bc47e7416cfb1dc2d12d3db"><div class="ttname"><a href="structTangram_1_1BoundingBox__t.html#ad4ae706e0bc47e7416cfb1dc2d12d3db">Tangram::BoundingBox_t::max</a></div><div class="ttdeci">double max[D]</div><div class="ttdef"><b>Definition:</b> tangram.h:229</div></div>
<div class="ttc" id="classTangram_1_1Vector_html_a18e2941185b8227b1bcb1f460abb12bb"><div class="ttname"><a href="classTangram_1_1Vector.html#a18e2941185b8227b1bcb1f460abb12bb">Tangram::Vector::is_zero</a></div><div class="ttdeci">bool is_zero() const</div><div class="ttdoc">Check if this Vector is a zero Vector. </div><div class="ttdef"><b>Definition:</b> Vector.h:180</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_aba885f75525c109661a08cb41a413a5b"><div class="ttname"><a href="classTangram_1_1MatPoly.html#aba885f75525c109661a08cb41a413a5b">Tangram::MatPoly::face_planes</a></div><div class="ttdeci">void face_planes(std::vector&lt; Plane_t&lt; D &gt; &gt; &amp;fplanes) const</div><div class="ttdoc">For every face, returns a plane containing that face. Important: faces should be planar, so you might need to facetize the MatPoly first. Faces with area below machine epsilon will be omitted. If the number of valid planes is less than four, empty vector will be returned. </div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_acf9b8b3197a7b4dd7089042843020fa3"><div class="ttname"><a href="classTangram_1_1MatPoly.html#acf9b8b3197a7b4dd7089042843020fa3">Tangram::MatPoly::~MatPoly</a></div><div class="ttdeci">~MatPoly()</div><div class="ttdef"><b>Definition:</b> MatPoly.h:133</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_aac14f299f075ed1688c24103e1b268ac"><div class="ttname"><a href="classTangram_1_1MatPoly.html#aac14f299f075ed1688c24103e1b268ac">Tangram::MatPoly::operator=</a></div><div class="ttdeci">MatPoly &amp; operator=(const MatPoly &amp;source_poly)</div><div class="ttdoc">Assignment operator. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:139</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_affd023482f50eeae0d97c7fa6697e358"><div class="ttname"><a href="classTangram_1_1MatPoly.html#affd023482f50eeae0d97c7fa6697e358">Tangram::MatPoly::face_vertices</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; int &gt; &gt; &amp; face_vertices() const</div><div class="ttdoc">All indices of vertices of the material poly&amp;#39;s faces. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:237</div></div>
<div class="ttc" id="namespaceTangram_html_a4184eb3e83186cdabf000f3129adca24"><div class="ttname"><a href="namespaceTangram.html#a4184eb3e83186cdabf000f3129adca24">Tangram::polygon3d_area</a></div><div class="ttdeci">double polygon3d_area(const std::vector&lt; Point3 &gt; &amp;points, const std::vector&lt; int &gt; &amp;poly_vertices)</div><div class="ttdef"><b>Definition:</b> MatPoly.h:19</div></div>
<div class="ttc" id="structTangram_1_1BoundingBox__t_html_ab255aa2370f495b3c8b00f2a92ea72b0"><div class="ttname"><a href="structTangram_1_1BoundingBox__t.html#ab255aa2370f495b3c8b00f2a92ea72b0">Tangram::BoundingBox_t::min</a></div><div class="ttdeci">double min[D]</div><div class="ttdef"><b>Definition:</b> tangram.h:228</div></div>
<div class="ttc" id="namespaceTangram_html_a71c39deca72d48990415ee231a9170b1"><div class="ttname"><a href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">Tangram::vector</a></div><div class="ttdeci">std::vector&lt; T &gt; vector</div><div class="ttdef"><b>Definition:</b> tangram.h:137</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_a0fde16656a5d88e5d7574fcd67b3ebcb"><div class="ttname"><a href="classTangram_1_1MatPoly.html#a0fde16656a5d88e5d7574fcd67b3ebcb">Tangram::MatPoly::initialize</a></div><div class="ttdeci">void initialize(const std::vector&lt; Point2 &gt; &amp;poly_points)</div><div class="ttdoc">Initialize a 2D polygon from its vertices. </div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_aa32646522284f28e04aad59e815542f1"><div class="ttname"><a href="classTangram_1_1MatPoly.html#aa32646522284f28e04aad59e815542f1">Tangram::MatPoly::num_vertices</a></div><div class="ttdeci">int num_vertices() const</div><div class="ttdoc">Number of material poly&amp;#39;s vertices. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:278</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_a4ffd8855a46fd704ce7749d43f8ded4e"><div class="ttname"><a href="classTangram_1_1MatPoly.html#a4ffd8855a46fd704ce7749d43f8ded4e">Tangram::MatPoly::reset_mat_id</a></div><div class="ttdeci">void reset_mat_id()</div><div class="ttdoc">Set the material ID for this poly to the undefined state. </div><div class="ttdef"><b>Definition:</b> MatPoly.h:168</div></div>
</div><!-- fragment --></div><!-- contents -->
<!--
This file is part of the Ristra tangram project.
Please see the license file at the root of this repository, or at:
https://github.com/laristra/tangram/blob/master/LICENSE
-->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<!--<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address> -->
<footer id="footer" class="footer">
  <div class="container">
    <div class="row test-muted">
      <div class="footer-row col-md-6">Copyright &copy; 2019
	<a href="http://lanl.gov"> Triad National Security, LLC</a>
	All Rights Reserved.
      </div>
      <div class="footer-row col-md-2">
	<a href="https://github.com/laristra/tangram/blob/master/LICENSE">
	  BSD LICENSE
	</a>
      </div>
      <div class="footer-row col-md-2">
	LA-CC-17-133
      </div>
      <div class="footer-row col-md-1">
	<a href="mailto:portage@lanl.gov">
	  <i class="fa fa-envelope-o fa-2x"></i>
	</a>
      </div>
      <div class="footer-row col-md-1">
	<a href="https://github.com/laristra/tangram">
	  <i class="fa fa-github fa-2x"></i>
	</a>
      </div>
    </div>
  </div>
</footer>
<script type="text/javascript" src="doxy-boot.js"></script>
</body>
</html>
