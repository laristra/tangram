<!--
This file is part of the Ristra tangram project.
Please see the license file at the root of this repository, or at:
https://github.com/laristra/tangram/blob/master/LICENSE
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="generator" content="Doxygen 1.8.13"/>
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <!-- Font stuff -->
    <link href='//fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'/>
    <script src="//use.fontawesome.com/3dce4d8e65.js"></script>
    <!-- the default version jquery provided by doxygen is too old for bootstrap
	 but it also contains local modifications.  we have extracted those that
	 are needed so that we can use a newer jquery. -->
    <!-- <script type="text/javascript" src="//code.jquery.com/jquery-3.1.1.min.js"></script> -->
    <script
			  src="//code.jquery.com/jquery-3.3.1.min.js"
			  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
			  crossorigin="anonymous"></script>
      <!-- <script src="//code.jquery.com/jquery-3.3.1.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
    <script type="text/javascript" src="smartmenu.js"></script>
    <title>tangram: /home/portage/tangram/tangram/utility/rpgtools/cuts.h Source File</title>
    <link href="tabs.css" rel="stylesheet" type="text/css">
      <!-- this version is too old for bootstrap, but it includes modifications
	   from standard jquery
    <script type="text/javascript" src="jquery.js"></script>  -->
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="//stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="//stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/> -->
    <!-- <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
  </head>
  <body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand">tangram </a>
        </div>
      </div>
    </nav>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div class="content" id="content">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 panel " style="padding-bottom: 15px;">
              <div style="margin-bottom: 15px;">
      		<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_043c38e9c2239d2104f02eee845ed8d8.html">tangram</a></li><li class="navelem"><a class="el" href="dir_8c062d6981e3de3ea58d7a81e2ec1253.html">utility</a></li><li class="navelem"><a class="el" href="dir_2320237e5553978ad9b08602cfa52a5a.html">rpgtools</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cuts.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cuts_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> This file is part of the Ristra tangram project.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> Please see the license file at the root of this repository, or at:</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> https://github.com/laristra/tangram/blob/master/LICENSE</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#ifndef RPG_TOOLS_CUTS_H_</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define RPG_TOOLS_CUTS_H_</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;wonton/intersect/r3d/r3d.h&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;}</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tangram_8h.html">tangram/support/tangram.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="split__r3d_8h.html">tangram/intersect/split_r3d.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="cuts_8h.html#a31db65ba832e31cbe963f3a039337646">   22</a></span>&#160;<span class="preprocessor">#define BUGS_IN_R3D 1</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">   24</a></span>&#160;<span class="preprocessor">#define R3D_POLY_ORDER 1</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/* Functions for intersection-based generation of reference</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">   material polyhedra. Given data on a collection of polyhedra</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">   generates sub-collections by splitting the original polyhedra</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">   with a plane or cutting out a polyhedral shape.</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">   Uses r3d.</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">   Collection of single-material polyhedra sets can be </span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">   converted to the format used by the Tangram&#39;s driver */</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="namespaceR3DPOLY.html">   34</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceR3DPOLY.html">R3DPOLY</a> {</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476">   35</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476">Position</a> {</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476a89677de1619bc4e547fb084eb72fcee9">   36</a></span>&#160;    <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476ad326fe9d7be3050967d63e0f04bf0dc3">INSIDE</a>, <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476a7625300bf4886037ed4e0afd3e3aec4c">INTERSECTS</a>, <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476a89677de1619bc4e547fb084eb72fcee9">OUTSIDE</a></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  };</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;}</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structRefPolyData__t.html">   40</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structRefPolyData__t.html">RefPolyData_t</a> {</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="structRefPolyData__t.html#a054cd38944c9548bd7f649655ed50850">   41</a></span>&#160;  <a class="code" href="structr3d__poly.html">r3d_poly</a> <a class="code" href="structRefPolyData__t.html#a054cd38944c9548bd7f649655ed50850">r3dpoly</a>;   <span class="comment">// geometry</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="structRefPolyData__t.html#a82d1deaa28cb2706df806a205afb30bb">   42</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structRefPolyData__t.html#a82d1deaa28cb2706df806a205afb30bb">cellID</a>;         <span class="comment">// ID of the containing cell</span></div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="structRefPolyData__t.html#aefb0fa5ae17ee93b7660f0c9757e76e9">   43</a></span>&#160;  <a class="code" href="r3d_8h.html#aa30ff2c6771668f327e1b0e4bd5cb58f">r3d_real</a> moments[<a class="code" href="r3d_8h.html#ace7c6f2c67e44a0a24c13f4cd1dbf138">R3D_NUM_MOMENTS</a>(<a class="code" href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">R3D_POLY_ORDER</a>)]; <span class="comment">// moments</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;};</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="classr3d__poly__intersect__check.html">   50</a></span>&#160;<span class="keyword">class </span><a class="code" href="classr3d__poly__intersect__check.html">r3d_poly_intersect_check</a> {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classr3d__poly__intersect__check.html#acea1efdd03e3a84b7140af6efe3bd586">   60</a></span>&#160;  <a class="code" href="classr3d__poly__intersect__check.html#acea1efdd03e3a84b7140af6efe3bd586">r3d_poly_intersect_check</a>(<span class="keyword">const</span> <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; polys_data,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                           <span class="keyword">const</span> std::vector&lt;int&gt;&amp; IDs_to_check,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">double</span> dst_tol,</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classTangram_1_1MatPoly.html">Tangram::MatPoly&lt;3&gt;</a>&amp; convex_matpoly) :</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                           polys_data_(polys_data), IDs_to_check_(IDs_to_check),</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                           dst_tol_(dst_tol), convex_matpoly_(convex_matpoly) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    std::vector&lt; Tangram::Plane_t&lt;3&gt; &gt; fplanes;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    convex_matpoly_.face_planes(fplanes);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">int</span> nplanes = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(fplanes.size());</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    face_planes_.resize(nplanes);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">//Face planes, used to find the intersection with convex_matpoly</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iplane = 0; iplane &lt; nplanes; iplane++) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ixyz = 0; ixyz &lt; 3; ixyz++)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        face_planes_[iplane].n.xyz[ixyz] = -fplanes[iplane].normal[ixyz];</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      face_planes_[iplane].d = -fplanes[iplane].dist2origin;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  }</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="classr3d__poly__intersect__check.html#a538e0681f2ed2a0b15c5d0eadce69391">   87</a></span>&#160;  <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476">R3DPOLY::Position</a> <a class="code" href="classr3d__poly__intersect__check.html#a538e0681f2ed2a0b15c5d0eadce69391">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> checkID)<span class="keyword"> const </span>{</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">int</span> polyID = IDs_to_check_[checkID];</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">const</span> <a class="code" href="structr3d__poly.html">r3d_poly</a>&amp; r3dpoly = polys_data_[polyID]-&gt;r3dpoly;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">bool</span> intersects = <span class="keyword">false</span>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ivrt = 0; ivrt &lt; r3dpoly.<a class="code" href="structr3d__poly.html#a49cb139c24b05f1ce30bc385f6938b50">nverts</a>; ivrt++) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <a class="code" href="classTangram_1_1Point.html">Tangram::Point3</a> cur_vrt;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ixyz = 0; ixyz &lt; 3; ixyz++)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        cur_vrt[ixyz] = r3dpoly.<a class="code" href="structr3d__poly.html#a3a696a7627e82ee03e826c5ef5b19fe2">verts</a>[ivrt].<a class="code" href="structr3d__vertex.html#aaf9a4d5cce69d3fbca4ecd7d215071f5">pos</a>.<a class="code" href="unionr3d__rvec3.html#ab127c0310533e3caaafcad80b7280fe1">xyz</a>[ixyz];</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      if (<a class="code" href="namespaceTangram.html#a06e9c97f69aeca40afb983ab4c229059">Tangram::point_inside_matpoly</a>(convex_matpoly_, cur_vrt, dst_tol_, <span class="keyword">true</span>)) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">if</span> (!intersects &amp;&amp; (ivrt &gt; 0)) <span class="keywordflow">return</span> <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476a7625300bf4886037ed4e0afd3e3aec4c">R3DPOLY::Position::INTERSECTS</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        intersects = <span class="keyword">true</span>;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (intersects) <span class="keywordflow">return</span> <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476a7625300bf4886037ed4e0afd3e3aec4c">R3DPOLY::Position::INTERSECTS</a>;  </div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (intersects) <span class="keywordflow">return</span> <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476ad326fe9d7be3050967d63e0f04bf0dc3">R3DPOLY::Position::INSIDE</a>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">//Instead of checking if MatPoly vertices are inside the r3d_poly,</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">//we look at the volume of the actual intersection</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="structr3d__poly.html">r3d_poly</a> intersection = r3dpoly;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iplane = 0; iplane &lt; face_planes_.size(); iplane++) {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="structr3d__plane.html">r3d_plane</a> cur_plane = face_planes_[iplane];</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="r3d_8h.html#ab3f21c5ada02190326fbe535032bfbe0">r3d_clip</a>(&amp;intersection, &amp;cur_plane, 1);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">if</span> (intersection.<a class="code" href="structr3d__poly.html#a49cb139c24b05f1ce30bc385f6938b50">nverts</a> == 0) <span class="keywordflow">return</span> <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476a89677de1619bc4e547fb084eb72fcee9">R3DPOLY::Position::OUTSIDE</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    </div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476a7625300bf4886037ed4e0afd3e3aec4c">R3DPOLY::Position::INTERSECTS</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keyword">const</span> std::vector&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; polys_data_;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keyword">const</span> std::vector&lt;int&gt;&amp; IDs_to_check_;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keyword">const</span> <a class="code" href="classTangram_1_1MatPoly.html">Tangram::MatPoly&lt;3&gt;</a>&amp; convex_matpoly_;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dst_tol_;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  std::vector&lt;r3d_plane&gt; face_planes_;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;};</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="structPolyHalfspaceData__t.html">  126</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structPolyHalfspaceData__t.html">PolyHalfspaceData_t</a> {</div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="structPolyHalfspaceData__t.html#a4179dd4e8a492208bab68af7c3b05d5b">  127</a></span>&#160;  std::shared_ptr&lt;RefPolyData_t&gt; <a class="code" href="structPolyHalfspaceData__t.html#a4179dd4e8a492208bab68af7c3b05d5b">lower</a>;</div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="structPolyHalfspaceData__t.html#aae79baaa04dc8e6a7957db39c74a0b59">  128</a></span>&#160;  std::shared_ptr&lt;RefPolyData_t&gt; <a class="code" href="structPolyHalfspaceData__t.html#aae79baaa04dc8e6a7957db39c74a0b59">upper</a>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;};</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classr3d__split__operator.html">  136</a></span>&#160;<span class="keyword">class </span><a class="code" href="classr3d__split__operator.html">r3d_split_operator</a> {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classr3d__split__operator.html#afc39655554f0293936377b67ce8bfe87">  145</a></span>&#160;  <a class="code" href="classr3d__split__operator.html#afc39655554f0293936377b67ce8bfe87">r3d_split_operator</a>(<span class="keyword">const</span> <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; polys_data,</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                     <span class="keyword">const</span> <a class="code" href="structr3d__plane.html">r3d_plane</a>&amp; cutting_plane,</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> vol_tol) :</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                     polys_data_(polys_data), cutting_plane_(cutting_plane),</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                     vol_tol_(vol_tol) {}</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classr3d__split__operator.html#aa0689241058157df7cc44e2866658ca7">  158</a></span>&#160;  <a class="code" href="structPolyHalfspaceData__t.html">PolyHalfspaceData_t</a> <a class="code" href="classr3d__split__operator.html#aa0689241058157df7cc44e2866658ca7">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> polyID)<span class="keyword"> const </span>{</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="structPolyHalfspaceData__t.html">PolyHalfspaceData_t</a> hs_data = {.<a class="code" href="structPolyHalfspaceData__t.html#a4179dd4e8a492208bab68af7c3b05d5b">lower</a> = std::make_shared&lt;RefPolyData_t&gt;(), </div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                   .upper = std::make_shared&lt;RefPolyData_t&gt;() };</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keyword">const</span> <a class="code" href="structr3d__poly.html">r3d_poly</a>&amp; r3dpoly = polys_data_[polyID]-&gt;r3dpoly;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keyword">const</span> <a class="code" href="r3d_8h.html#aa30ff2c6771668f327e1b0e4bd5cb58f">r3d_real</a>* poly_moments = polys_data_[polyID]-&gt;moments;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">int</span> cellID = polys_data_[polyID]-&gt;cellID;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="structr3d__poly.html">r3d_poly</a> split_poly = r3dpoly;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="r3d_8h.html#aad337c9fbabbd571b25490c27f3709d9">r3d_split</a>(&amp;split_poly, 1, cutting_plane_, &amp;hs_data.<a class="code" href="structPolyHalfspaceData__t.html#aae79baaa04dc8e6a7957db39c74a0b59">upper</a>-&gt;r3dpoly, &amp;hs_data.<a class="code" href="structPolyHalfspaceData__t.html#a4179dd4e8a492208bab68af7c3b05d5b">lower</a>-&gt;r3dpoly);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#if BUGS_IN_R3D</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    std::shared_ptr&lt;RefPolyData_t&gt; hs_data_ptrs[2] = {hs_data.<a class="code" href="structPolyHalfspaceData__t.html#a4179dd4e8a492208bab68af7c3b05d5b">lower</a>, hs_data.<a class="code" href="structPolyHalfspaceData__t.html#aae79baaa04dc8e6a7957db39c74a0b59">upper</a>};</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ihs = 0; ihs &lt; 2; ihs++) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">if</span> (hs_data_ptrs[ihs]-&gt;r3dpoly.<a class="code" href="structr3d__poly.html#a49cb139c24b05f1ce30bc385f6938b50">nverts</a> &gt; 0) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        std::vector&lt;r3d_poly&gt; poly_components;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="namespaceTangram.html#a43906bb61091453a4fc320c983f9c733">Tangram::r3d_poly_components</a>(hs_data_ptrs[ihs]-&gt;r3dpoly, poly_components, vol_tol_);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">if</span> (poly_components.empty())</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          hs_data_ptrs[ihs]-&gt;r3dpoly.<a class="code" href="structr3d__poly.html#a49cb139c24b05f1ce30bc385f6938b50">nverts</a> = 0;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          assert(poly_components.size() == 1);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          hs_data_ptrs[ihs]-&gt;r3dpoly = poly_components[0];</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          hs_data_ptrs[ihs]-&gt;cellID = cellID;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          <a class="code" href="r3d_8h.html#ae591f11a646bffc0b497ba6d440f326a">r3d_reduce</a>(&amp;hs_data_ptrs[ihs]-&gt;r3dpoly, hs_data_ptrs[ihs]-&gt;moments, <a class="code" href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">R3D_POLY_ORDER</a>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">bool</span> nnz_cutoff = <span class="keyword">false</span>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (hs_data.lower-&gt;r3dpoly.nverts &gt; 0) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="r3d_8h.html#ae591f11a646bffc0b497ba6d440f326a">r3d_reduce</a>(&amp;hs_data.lower-&gt;r3dpoly, hs_data.lower-&gt;moments, <a class="code" href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">R3D_POLY_ORDER</a>);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">if</span> (hs_data.lower-&gt;moments[0] &gt;= vol_tol) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        hs_data.lower-&gt;cellID = cellID;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        nnz_cutoff = <span class="keyword">true</span>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        hs_data.lower-&gt;r3dpoly.nverts = 0;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">if</span> (hs_data.upper-&gt;r3dpoly.nverts &gt; 0) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">if</span> (nnz_cutoff) {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im = 0; im &lt; <a class="code" href="r3d_8h.html#ace7c6f2c67e44a0a24c13f4cd1dbf138">R3D_NUM_MOMENTS</a>(<a class="code" href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">R3D_POLY_ORDER</a>); im++)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          hs_data.upper-&gt;moments[im] = </div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            poly_moments[im] - hs_data.lower-&gt;moments[im];</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      } </div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im = 0; im &lt; <a class="code" href="r3d_8h.html#ace7c6f2c67e44a0a24c13f4cd1dbf138">R3D_NUM_MOMENTS</a>(<a class="code" href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">R3D_POLY_ORDER</a>); im++)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          hs_data.upper-&gt;moments[im] = poly_moments[im];</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">if</span> (hs_data.upper-&gt;moments[0] &gt;= vol_tol)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        hs_data.upper-&gt;cellID = cellID;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">else</span>  </div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        hs_data.upper-&gt;r3dpoly.nverts = 0;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span> hs_data;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keyword">const</span> std::vector&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; polys_data_;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keyword">const</span> <a class="code" href="structr3d__plane.html">r3d_plane</a>&amp; cutting_plane_;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordtype">double</span> vol_tol_;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;};</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Mesh_Wrapper&gt;</div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="cuts_8h.html#aa95e1b49249bd95617916d20231b0409">  234</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cuts_8h.html#aa95e1b49249bd95617916d20231b0409">mesh_to_r3d_polys</a>(<span class="keyword">const</span> Mesh_Wrapper&amp; mesh,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                       <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; polys_data,</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> dst_tol,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">bool</span> decompose_cells) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">int</span> ncells = mesh.num_owned_cells() + mesh.num_ghost_cells();</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  polys_data.clear();</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icell = 0; icell &lt; ncells; icell++) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="classTangram_1_1MatPoly.html">Tangram::MatPoly&lt;3&gt;</a> mat_poly;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="namespaceTangram.html#a4a082d6df64712201cc18e4a3228eecc">Tangram::cell_get_matpoly</a>(mesh, icell, &amp;mat_poly, dst_tol);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    std::vector&lt; Tangram::MatPoly&lt;3&gt; &gt; cell_polys;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (decompose_cells)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      mat_poly.<a class="code" href="classTangram_1_1MatPoly.html#a8e814a40956aee6c5ade0c20abefe920">facetize_decompose</a>(cell_polys);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      cell_polys.push_back(mat_poly);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">int</span> num_polys = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(cell_polys.size());</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">int</span> offset = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(polys_data.size());</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    polys_data.resize(offset + num_polys);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icp = 0; icp &lt; num_polys; icp++) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      polys_data[offset + icp] = std::make_shared&lt;RefPolyData_t&gt;();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      polys_data[offset + icp]-&gt;cellID = icell;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <a class="code" href="namespaceTangram.html#a2364ea47380698d6b380574978c068da">Tangram::matpoly_to_r3dpoly</a>(cell_polys[icp], </div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                  polys_data[offset + icp]-&gt;r3dpoly);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="r3d_8h.html#ae591f11a646bffc0b497ba6d440f326a">r3d_reduce</a>(&amp;polys_data[offset + icp]-&gt;r3dpoly, </div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                 polys_data[offset + icp]-&gt;moments, <a class="code" href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">R3D_POLY_ORDER</a>);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="cuts_8h.html#a9693fcdc516437e3123f5b7a470474fb">  279</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cuts_8h.html#a9693fcdc516437e3123f5b7a470474fb">apply_plane</a>(<span class="keyword">const</span> <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; polys_data,</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                 <span class="keyword">const</span> <a class="code" href="structTangram_1_1Plane__t.html">Tangram::Plane_t&lt;3&gt;</a>&amp; planar_interface,</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                 <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; lower_hs_data,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                 <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; upper_hs_data,</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span> vol_tol) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  lower_hs_data.clear();</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  upper_hs_data.clear();</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  </div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordtype">int</span> num_polys = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(polys_data.size());</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordtype">int</span> nmoments = <a class="code" href="r3d_8h.html#ace7c6f2c67e44a0a24c13f4cd1dbf138">R3D_NUM_MOMENTS</a>(<a class="code" href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">R3D_POLY_ORDER</a>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="structr3d__plane.html">r3d_plane</a> r3d_planar_iface;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ixyz = 0; ixyz &lt; 3; ixyz++)</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    r3d_planar_iface.<a class="code" href="structr3d__plane.html#a6447f761d2c41d040a0fbdaa8e2885b1">n</a>.<a class="code" href="unionr3d__rvec3.html#ab127c0310533e3caaafcad80b7280fe1">xyz</a>[ixyz] = planar_interface.<a class="code" href="structTangram_1_1Plane__t.html#aeb5db1642a6d790563f1ae78154de428">normal</a>[ixyz];</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  r3d_planar_iface.<a class="code" href="structr3d__plane.html#a82422a38dd2d1975d11d9d0ca6172027">d</a> = planar_interface.<a class="code" href="structTangram_1_1Plane__t.html#a0de6ac6eb2b34ebc3d70ced8df621ce5">dist2origin</a>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="classr3d__split__operator.html">r3d_split_operator</a> r3d_split_op(polys_data, r3d_planar_iface, vol_tol);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">Tangram::vector&lt; PolyHalfspaceData_t &gt;</a> hs_data(num_polys);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <a class="code" href="namespaceTangram.html#a3d06c411beaeb41e4c0bfcc33aa2aad5">Tangram::transform</a>(<a class="code" href="namespaceTangram.html#a98727a028a358f4388fadeb519401bce">Tangram::make_counting_iterator</a>(0), </div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                     <a class="code" href="namespaceTangram.html#a98727a028a358f4388fadeb519401bce">Tangram::make_counting_iterator</a>(num_polys),</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                     hs_data.begin(), r3d_split_op);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipoly = 0; ipoly &lt; num_polys; ipoly++) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">const</span> <a class="code" href="structPolyHalfspaceData__t.html">PolyHalfspaceData_t</a>&amp; poly_hs_data = hs_data[ipoly];</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">if</span> (poly_hs_data.<a class="code" href="structPolyHalfspaceData__t.html#a4179dd4e8a492208bab68af7c3b05d5b">lower</a>-&gt;r3dpoly.nverts &gt; 0) </div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      lower_hs_data.push_back(poly_hs_data.<a class="code" href="structPolyHalfspaceData__t.html#a4179dd4e8a492208bab68af7c3b05d5b">lower</a>);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (poly_hs_data.<a class="code" href="structPolyHalfspaceData__t.html#aae79baaa04dc8e6a7957db39c74a0b59">upper</a>-&gt;r3dpoly.nverts &gt; 0) </div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      upper_hs_data.push_back(poly_hs_data.<a class="code" href="structPolyHalfspaceData__t.html#aae79baaa04dc8e6a7957db39c74a0b59">upper</a>);    </div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="cuts_8h.html#a2f4288fd84e1ea74595102bf44b87e31">  322</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cuts_8h.html#a2f4288fd84e1ea74595102bf44b87e31">sort_wrt_convex_poly</a>(<span class="keyword">const</span> <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; polys_data,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                          <span class="keyword">const</span> <a class="code" href="classTangram_1_1MatPoly.html">Tangram::MatPoly&lt;3&gt;</a>&amp; convex_matpoly,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                          std::vector&lt;int&gt;&amp; iinterior_polys,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                          std::vector&lt;int&gt;&amp; iinstersecting_polys,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                          std::vector&lt;int&gt;&amp; iexterior_polys,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">double</span> dst_tol) {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  std::vector&lt; Tangram::Plane_t&lt;3&gt; &gt; face_planes;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  convex_matpoly.<a class="code" href="classTangram_1_1MatPoly.html#aba885f75525c109661a08cb41a413a5b">face_planes</a>(face_planes);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="structTangram_1_1BoundingBox__t.html">Tangram::BoundingBox_t&lt;3&gt;</a> poly_bbox = convex_matpoly.<a class="code" href="classTangram_1_1MatPoly.html#aff224788989415116c567aabc00f578b">bounding_box</a>();</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordtype">int</span> nfaces = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(face_planes.size());</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordtype">int</span> npolys = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(polys_data.size()); </div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  iexterior_polys.clear();</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  std::vector&lt;int&gt; iin_box_polys;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipoly = 0; ipoly &lt; npolys; ipoly++) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="structTangram_1_1BoundingBox__t.html">Tangram::BoundingBox_t&lt;3&gt;</a> cur_bbox = </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <a class="code" href="namespaceTangram.html#a76a989a601d36db6dab4fcec22ed85fe">Tangram::r3d_poly_bounding_box</a>(polys_data[ipoly]-&gt;r3dpoly);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespaceTangram.html#a470a7322feda68737ae68a53d47d2418">overlapping_boxes</a>(cur_bbox, poly_bbox, dst_tol))</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      iin_box_polys.push_back(ipoly);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      iexterior_polys.push_back(ipoly);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">//Sort out the polys inside the box</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordtype">int</span> num_in_box = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(iin_box_polys.size());</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="classr3d__poly__intersect__check.html">r3d_poly_intersect_check</a> r3d_isect_check(polys_data, iin_box_polys, </div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                           dst_tol, convex_matpoly);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">Tangram::vector&lt;R3DPOLY::Position&gt;</a> check_result(num_in_box);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <a class="code" href="namespaceTangram.html#a3d06c411beaeb41e4c0bfcc33aa2aad5">Tangram::transform</a>(<a class="code" href="namespaceTangram.html#a98727a028a358f4388fadeb519401bce">Tangram::make_counting_iterator</a>(0), </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                     <a class="code" href="namespaceTangram.html#a98727a028a358f4388fadeb519401bce">Tangram::make_counting_iterator</a>(num_in_box),</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                     check_result.begin(), r3d_isect_check);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  iinterior_polys.clear();</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  iinstersecting_polys.clear();</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iip = 0; iip &lt; num_in_box; iip++)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">switch</span> (check_result[iip]) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476a89677de1619bc4e547fb084eb72fcee9">R3DPOLY::Position::OUTSIDE</a>: </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;               iexterior_polys.push_back(iin_box_polys[iip]);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476a7625300bf4886037ed4e0afd3e3aec4c">R3DPOLY::Position::INTERSECTS</a>: </div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;               iinstersecting_polys.push_back(iin_box_polys[iip]);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476ad326fe9d7be3050967d63e0f04bf0dc3">R3DPOLY::Position::INSIDE</a>: </div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;               iinterior_polys.push_back(iin_box_polys[iip]);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Undefined position&quot;</span>);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="cuts_8h.html#aec6506dfb91f930088d22cde1b317345">  382</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cuts_8h.html#aec6506dfb91f930088d22cde1b317345">extract_data</a>(<span class="keyword">const</span> <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; polys_data,</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                  <span class="keyword">const</span> std::vector&lt;int&gt;&amp; set_ipolys,</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                  <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; set_data ) {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordtype">int</span> num_set_polys = set_ipolys.size();</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  set_data.clear();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  set_data.reserve(num_set_polys);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isp = 0; isp &lt; num_set_polys; isp++)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    set_data.push_back(polys_data[set_ipolys[isp]]);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;}</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="cuts_8h.html#ada8f3f960ae9834b492be70f14ca85fa">  405</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cuts_8h.html#ada8f3f960ae9834b492be70f14ca85fa">apply_poly</a>(<span class="keyword">const</span> <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; polys_data,</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="keyword">const</span> <a class="code" href="classTangram_1_1MatPoly.html">Tangram::MatPoly&lt;3&gt;</a>&amp; mat_poly,</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; interior_data,</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt;&amp; exterior_data,</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> vol_tol,</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> dst_tol,</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">bool</span> convex_matpoly) {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordflow">if</span> (convex_matpoly) {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">//We need to make sure that we only split r3d_polys that actually</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">//intersect the MatPoly</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    std::vector&lt;int&gt; iexterior_polys, iinstersecting_polys, iinterior_polys;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="cuts_8h.html#a2f4288fd84e1ea74595102bf44b87e31">sort_wrt_convex_poly</a>(polys_data, mat_poly, iinterior_polys, </div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                         iinstersecting_polys, iexterior_polys, dst_tol);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="cuts_8h.html#aec6506dfb91f930088d22cde1b317345">extract_data</a>(polys_data, iinterior_polys, interior_data);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="cuts_8h.html#aec6506dfb91f930088d22cde1b317345">extract_data</a>(polys_data, iexterior_polys, exterior_data);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    std::vector&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt; intersection_data;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="cuts_8h.html#aec6506dfb91f930088d22cde1b317345">extract_data</a>(polys_data, iinstersecting_polys, intersection_data);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    </div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    std::vector&lt; Tangram::Plane_t&lt;3&gt; &gt; face_planes;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    mat_poly.<a class="code" href="classTangram_1_1MatPoly.html#aba885f75525c109661a08cb41a413a5b">face_planes</a>(face_planes);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordtype">int</span> nfaces = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(face_planes.size());</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">//We cut with face planes slicing off exterior polys on each step</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface = 0; iface &lt; nfaces; iface++) {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      std::vector&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt; upd_intersection_data, </div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                                    new_exterior_data;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                                  </div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="comment">//Face normal is pointing outward</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <a class="code" href="cuts_8h.html#a9693fcdc516437e3123f5b7a470474fb">apply_plane</a>(intersection_data, face_planes[iface], </div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                  upd_intersection_data, new_exterior_data, vol_tol);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      intersection_data = upd_intersection_data;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      exterior_data.reserve(exterior_data.size() + new_exterior_data.size());</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      exterior_data.insert(exterior_data.end(), </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                           new_exterior_data.begin(), new_exterior_data.end());</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    interior_data.reserve(interior_data.size() + intersection_data.size());</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    interior_data.insert(interior_data.end(), </div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                         intersection_data.begin(), intersection_data.end());</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    interior_data.clear();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    std::vector&lt; Tangram::MatPoly&lt;3&gt; &gt; matpoly_tets;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    mat_poly.<a class="code" href="classTangram_1_1MatPoly.html#a8e814a40956aee6c5ade0c20abefe920">facetize_decompose</a>(matpoly_tets);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordtype">int</span> ntets = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(matpoly_tets.size());</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    std::vector&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt; remaining_data = polys_data;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itet = 0; itet &lt; ntets; itet++) {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="comment">//We need to make sure that we only split r3d_polys that actually</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="comment">//intersect the tets of MatPoly</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      std::vector&lt;int&gt; iexterior_polys, iinstersecting_polys, iinterior_polys;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <a class="code" href="cuts_8h.html#a2f4288fd84e1ea74595102bf44b87e31">sort_wrt_convex_poly</a>(remaining_data, matpoly_tets[itet], iinterior_polys,</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                           iinstersecting_polys, iexterior_polys, dst_tol);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      </div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      std::vector&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt; tet_interior_data, </div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                                    intersection_data;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <a class="code" href="cuts_8h.html#aec6506dfb91f930088d22cde1b317345">extract_data</a>(remaining_data, iexterior_polys, exterior_data);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <a class="code" href="cuts_8h.html#aec6506dfb91f930088d22cde1b317345">extract_data</a>(remaining_data, iinstersecting_polys, intersection_data);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <a class="code" href="cuts_8h.html#aec6506dfb91f930088d22cde1b317345">extract_data</a>(remaining_data, iinterior_polys, tet_interior_data);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      interior_data.reserve(interior_data.size() + tet_interior_data.size());</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      interior_data.insert(interior_data.end(), </div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                           tet_interior_data.begin(), tet_interior_data.end());</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      std::vector&lt; Tangram::Plane_t&lt;3&gt; &gt; face_planes;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      matpoly_tets[itet].face_planes(face_planes);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="comment">//We cut with face planes slicing off exterior polys on each step</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iface = 0; iface &lt; 4; iface++) {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        std::vector&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt; upd_intersection_data, </div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                                      new_exterior_data;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="comment">//Face normal is pointing outward</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <a class="code" href="cuts_8h.html#a9693fcdc516437e3123f5b7a470474fb">apply_plane</a>(intersection_data, face_planes[iface], </div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    upd_intersection_data, new_exterior_data, vol_tol);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        intersection_data = upd_intersection_data;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        exterior_data.reserve(exterior_data.size() + new_exterior_data.size());</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        exterior_data.insert(exterior_data.end(), </div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                             new_exterior_data.begin(), new_exterior_data.end());</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="comment">//Poly is interior if it&#39;s interior for any one tets</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      interior_data.reserve(interior_data.size() + intersection_data.size());</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      interior_data.insert(interior_data.end(), </div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                           intersection_data.begin(), intersection_data.end());</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;          </div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="comment">//Poly is exterior if it&#39;s exterior for all the tets, so we keep</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="comment">//cutting out tets from the current exterior list</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      remaining_data = exterior_data;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="cuts_8h.html#ae9945c15826a9c1b5c141db314b7f8b4">  505</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="cuts_8h.html#ae9945c15826a9c1b5c141db314b7f8b4">factorial</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n)</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;{</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> res = 1;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n; ++i)</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      res *= i + 1;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;}</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> Mesh_Wrapper&gt;</div><div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="cuts_8h.html#af4145e83e4fe14c7e3a657eafca5c939">  533</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="cuts_8h.html#af4145e83e4fe14c7e3a657eafca5c939">finalize_ref_data</a>(<span class="keyword">const</span> Mesh_Wrapper&amp; mesh,</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                       <span class="keyword">const</span> <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::shared_ptr&lt;RefPolyData_t&gt; &gt; &gt;&amp; </div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                         ref_sets_data,</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                       <span class="keyword">const</span> std::vector&lt;int&gt;&amp; sets_material_IDs,</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                       std::vector&lt;int&gt;&amp; cell_num_mats,</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                       std::vector&lt;int&gt;&amp; cell_mat_ids,</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                       std::vector&lt;double&gt;&amp; cell_mat_volfracs,</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                       <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="classTangram_1_1Point.html">Tangram::Point&lt;3&gt;</a> &gt;&amp; cell_mat_centroids,</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> dst_tol,</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">bool</span> decompose_cells,</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                       <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; <a class="code" href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">std::vector</a>&lt; std::vector&lt;r3d_poly&gt; &gt; &gt;*</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                         reference_mat_polys = <span class="keyword">nullptr</span>) {                     </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordtype">int</span> ncells = -1, nsets = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(ref_sets_data.size());</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iset = 0; iset &lt; nsets; iset++) {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordtype">int</span> set_max_cellID = -1;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipoly = 0; ipoly &lt; ref_sets_data[iset].size(); ipoly++)</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordflow">if</span> (ref_sets_data[iset][ipoly]-&gt;cellID &gt; set_max_cellID)</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        set_max_cellID = ref_sets_data[iset][ipoly]-&gt;cellID;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span> (set_max_cellID &gt; ncells) ncells = set_max_cellID;  </div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  ncells++;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordtype">int</span> nmoments = <a class="code" href="r3d_8h.html#ace7c6f2c67e44a0a24c13f4cd1dbf138">R3D_NUM_MOMENTS</a>(<a class="code" href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">R3D_POLY_ORDER</a>);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  std::vector&lt; std::vector&lt;int&gt; &gt; cells_mat_ids(ncells);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  std::vector&lt; std::vector&lt; std::vector&lt;double&gt; &gt; &gt; cells_mat_moments(ncells);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">if</span> (reference_mat_polys != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    reference_mat_polys-&gt;clear();</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    reference_mat_polys-&gt;resize(ncells);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iset = 0; iset &lt; nsets; iset++) {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordtype">int</span> cur_mat_id = sets_material_IDs[iset];</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipoly = 0; ipoly &lt; ref_sets_data[iset].size(); ipoly++) {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keywordtype">int</span> icell = ref_sets_data[iset][ipoly]-&gt;cellID;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordtype">int</span> cell_mat_id = std::distance(cells_mat_ids[icell].begin(), </div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        std::find(cells_mat_ids[icell].begin(), cells_mat_ids[icell].end(), cur_mat_id));</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">if</span> (cell_mat_id == cells_mat_ids[icell].size()) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        cells_mat_ids[icell].resize(cell_mat_id + 1);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        cells_mat_moments[icell].resize(cell_mat_id + 1);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        cells_mat_moments[icell][cell_mat_id].resize(nmoments, 0.0);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        cells_mat_ids[icell][cell_mat_id] = cur_mat_id;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">if</span> (reference_mat_polys != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          (*reference_mat_polys)[icell].resize(cell_mat_id + 1);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keywordflow">if</span> (reference_mat_polys != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        (*reference_mat_polys)[icell][cell_mat_id].push_back(</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;          ref_sets_data[iset][ipoly]-&gt;r3dpoly);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im = 0; im &lt; nmoments; im++)</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        cells_mat_moments[icell][cell_mat_id][im] += </div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          ref_sets_data[iset][ipoly]-&gt;moments[im];</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  cell_num_mats.resize(ncells);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  cell_mat_ids.clear();</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  cell_mat_volfracs.clear();</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  cell_mat_centroids.clear();</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icell = 0; icell &lt; ncells; icell++) {</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordtype">int</span> ncmats = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(cells_mat_ids[icell].size());</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    cell_num_mats[icell] = ncmats;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    cell_mat_ids.insert(cell_mat_ids.end(), cells_mat_ids[icell].begin(), </div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                        cells_mat_ids[icell].end());</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordtype">int</span> offset = cell_mat_volfracs.size();</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    cell_mat_volfracs.resize(offset + cell_num_mats[icell]);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    cell_mat_centroids.resize(offset + cell_num_mats[icell]);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">if</span> (cell_num_mats[icell] == 1) {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="comment">// Single-material cell</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      cell_mat_volfracs[offset] = 1.0;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="comment">// We discard reference poly&#39;s for the cell and create a single new one</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <a class="code" href="classTangram_1_1MatPoly.html">Tangram::MatPoly&lt;3&gt;</a> cell_mat_poly;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <a class="code" href="structr3d__poly.html">r3d_poly</a> cell_r3d_poly;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <a class="code" href="namespaceTangram.html#a4a082d6df64712201cc18e4a3228eecc">Tangram::cell_get_matpoly</a>(mesh, icell, &amp;cell_mat_poly, dst_tol);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">if</span> (decompose_cells) {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <a class="code" href="classTangram_1_1MatPoly.html">Tangram::MatPoly&lt;3&gt;</a> flat_face_matpoly;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        cell_mat_poly.<a class="code" href="classTangram_1_1MatPoly.html#aa5681ccd23930482bb6b3c243fb4425c">faceted_matpoly</a>(&amp;flat_face_matpoly);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <a class="code" href="namespaceTangram.html#a2364ea47380698d6b380574978c068da">Tangram::matpoly_to_r3dpoly</a>(flat_face_matpoly, cell_r3d_poly);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <a class="code" href="namespaceTangram.html#a2364ea47380698d6b380574978c068da">Tangram::matpoly_to_r3dpoly</a>(cell_mat_poly, cell_r3d_poly);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">if</span> (reference_mat_polys != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        (*reference_mat_polys)[icell][0] = {cell_r3d_poly};</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <a class="code" href="r3d_8h.html#aa30ff2c6771668f327e1b0e4bd5cb58f">r3d_real</a> cell_moments[<a class="code" href="r3d_8h.html#ace7c6f2c67e44a0a24c13f4cd1dbf138">R3D_NUM_MOMENTS</a>(<a class="code" href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">R3D_POLY_ORDER</a>)];</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <a class="code" href="r3d_8h.html#ae591f11a646bffc0b497ba6d440f326a">r3d_reduce</a>(&amp;cell_r3d_poly, cell_moments, <a class="code" href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">R3D_POLY_ORDER</a>);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; 3; idim++)</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        cell_mat_centroids[offset][idim] = cell_moments[idim + 1]/cell_moments[0];</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">double</span> cell_mats_vol = 0.0;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icmat = 0; icmat &lt; cell_num_mats[icell]; icmat++)</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      cell_mats_vol += cells_mat_moments[icell][icmat][0];</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icmat = 0; icmat &lt; cell_num_mats[icell]; icmat++) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      cell_mat_volfracs[offset + icmat] = </div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        cells_mat_moments[icell][icmat][0]/cell_mats_vol;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; 3; idim++)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        cell_mat_centroids[offset + icmat][idim] = </div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;          cells_mat_moments[icell][icmat][idim + 1]/cells_mat_moments[icell][icmat][0];</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  }</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;}</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="namespaceTangram_html_a4a082d6df64712201cc18e4a3228eecc"><div class="ttname"><a href="namespaceTangram.html#a4a082d6df64712201cc18e4a3228eecc">Tangram::cell_get_matpoly</a></div><div class="ttdeci">void cell_get_matpoly(const Mesh_Wrapper &amp;Mesh, const int cellid, MatPoly&lt; 2 &gt; *mat_poly, const double dst_tol)</div><div class="ttdoc">Initializes a material polygon that corresponds to (i.e. has the same geometry as) a given mesh cell...</div><div class="ttdef"><b>Definition:</b> MatPoly.h:746</div></div>
<div class="ttc" id="r3d_8h_html_ae591f11a646bffc0b497ba6d440f326a"><div class="ttname"><a href="r3d_8h.html#ae591f11a646bffc0b497ba6d440f326a">r3d_reduce</a></div><div class="ttdeci">void r3d_reduce(r3d_poly *poly, r3d_real *moments, r3d_int polyorder)</div></div>
<div class="ttc" id="structr3d__plane_html_a82422a38dd2d1975d11d9d0ca6172027"><div class="ttname"><a href="structr3d__plane.html#a82422a38dd2d1975d11d9d0ca6172027">r3d_plane::d</a></div><div class="ttdeci">r3d_real d</div><div class="ttdef"><b>Definition:</b> r3d.h:79</div></div>
<div class="ttc" id="structRefPolyData__t_html_a82d1deaa28cb2706df806a205afb30bb"><div class="ttname"><a href="structRefPolyData__t.html#a82d1deaa28cb2706df806a205afb30bb">RefPolyData_t::cellID</a></div><div class="ttdeci">int cellID</div><div class="ttdef"><b>Definition:</b> cuts.h:42</div></div>
<div class="ttc" id="classr3d__split__operator_html_aa0689241058157df7cc44e2866658ca7"><div class="ttname"><a href="classr3d__split__operator.html#aa0689241058157df7cc44e2866658ca7">r3d_split_operator::operator()</a></div><div class="ttdeci">PolyHalfspaceData_t operator()(const int polyID) const</div><div class="ttdoc">Splits a polyhedron with the cutting plane and returns data on its parts in the lower and the upper h...</div><div class="ttdef"><b>Definition:</b> cuts.h:158</div></div>
<div class="ttc" id="structPolyHalfspaceData__t_html"><div class="ttname"><a href="structPolyHalfspaceData__t.html">PolyHalfspaceData_t</a></div><div class="ttdef"><b>Definition:</b> cuts.h:126</div></div>
<div class="ttc" id="namespaceTangram_html_a06e9c97f69aeca40afb983ab4c229059"><div class="ttname"><a href="namespaceTangram.html#a06e9c97f69aeca40afb983ab4c229059">Tangram::point_inside_matpoly</a></div><div class="ttdeci">bool point_inside_matpoly(const MatPoly&lt; 3 &gt; mat_poly, const Point&lt; 3 &gt; &amp;pt, double dst_tol, bool convex_poly)</div><div class="ttdoc">Checks if a given point is interior wrt to a given polyhedron. Note: boundary points are no considere...</div><div class="ttdef"><b>Definition:</b> MatPoly.h:1136</div></div>
<div class="ttc" id="namespaceTangram_html_a43906bb61091453a4fc320c983f9c733"><div class="ttname"><a href="namespaceTangram.html#a43906bb61091453a4fc320c983f9c733">Tangram::r3d_poly_components</a></div><div class="ttdeci">void r3d_poly_components(const r3d_poly &amp;r3dpoly, std::vector&lt; r3d_poly &gt; &amp;poly_components, const double vol_tol)</div><div class="ttdoc">Breaks an r3d_poly into a vector of disjoint components. </div><div class="ttdef"><b>Definition:</b> split_r3d.h:83</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_a8e814a40956aee6c5ade0c20abefe920"><div class="ttname"><a href="classTangram_1_1MatPoly.html#a8e814a40956aee6c5ade0c20abefe920">Tangram::MatPoly::facetize_decompose</a></div><div class="ttdeci">void facetize_decompose(std::vector&lt; MatPoly&lt; D &gt; &gt; &amp;sub_polys) const</div><div class="ttdoc">Facetizes and decomposes this MatPoly into simplex MatPoly&amp;#39;s using its centroid. </div></div>
<div class="ttc" id="cuts_8h_html_aa95e1b49249bd95617916d20231b0409"><div class="ttname"><a href="cuts_8h.html#aa95e1b49249bd95617916d20231b0409">mesh_to_r3d_polys</a></div><div class="ttdeci">void mesh_to_r3d_polys(const Mesh_Wrapper &amp;mesh, std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;polys_data, const double dst_tol, const bool decompose_cells)</div><div class="ttdoc">Generates data for polyhedra corresponding to given mesh cells. </div><div class="ttdef"><b>Definition:</b> cuts.h:234</div></div>
<div class="ttc" id="structr3d__plane_html_a6447f761d2c41d040a0fbdaa8e2885b1"><div class="ttname"><a href="structr3d__plane.html#a6447f761d2c41d040a0fbdaa8e2885b1">r3d_plane::n</a></div><div class="ttdeci">r3d_rvec3 n</div><div class="ttdef"><b>Definition:</b> r3d.h:78</div></div>
<div class="ttc" id="namespaceR3DPOLY_html_ae900fb35bd45f210fcc3cf379902b476a7625300bf4886037ed4e0afd3e3aec4c"><div class="ttname"><a href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476a7625300bf4886037ed4e0afd3e3aec4c">R3DPOLY::INTERSECTS</a></div><div class="ttdef"><b>Definition:</b> cuts.h:36</div></div>
<div class="ttc" id="cuts_8h_html_af4145e83e4fe14c7e3a657eafca5c939"><div class="ttname"><a href="cuts_8h.html#af4145e83e4fe14c7e3a657eafca5c939">finalize_ref_data</a></div><div class="ttdeci">void finalize_ref_data(const Mesh_Wrapper &amp;mesh, const std::vector&lt; std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &gt; &amp;ref_sets_data, const std::vector&lt; int &gt; &amp;sets_material_IDs, std::vector&lt; int &gt; &amp;cell_num_mats, std::vector&lt; int &gt; &amp;cell_mat_ids, std::vector&lt; double &gt; &amp;cell_mat_volfracs, std::vector&lt; Tangram::Point&lt; 3 &gt; &gt; &amp;cell_mat_centroids, const double dst_tol, const bool decompose_cells, std::vector&lt; std::vector&lt; std::vector&lt; r3d_poly &gt; &gt; &gt; *reference_mat_polys=nullptr)</div><div class="ttdoc">For a given collections of single-material reference polyhedra sets generates data compatible with Ta...</div><div class="ttdef"><b>Definition:</b> cuts.h:533</div></div>
<div class="ttc" id="structPolyHalfspaceData__t_html_a4179dd4e8a492208bab68af7c3b05d5b"><div class="ttname"><a href="structPolyHalfspaceData__t.html#a4179dd4e8a492208bab68af7c3b05d5b">PolyHalfspaceData_t::lower</a></div><div class="ttdeci">std::shared_ptr&lt; RefPolyData_t &gt; lower</div><div class="ttdef"><b>Definition:</b> cuts.h:127</div></div>
<div class="ttc" id="r3d_8h_html_aa30ff2c6771668f327e1b0e4bd5cb58f"><div class="ttname"><a href="r3d_8h.html#aa30ff2c6771668f327e1b0e4bd5cb58f">r3d_real</a></div><div class="ttdeci">double r3d_real</div><div class="ttdoc">Real type specifying the precision to be used in calculations. </div><div class="ttdef"><b>Definition:</b> r3d.h:41</div></div>
<div class="ttc" id="structRefPolyData__t_html_a054cd38944c9548bd7f649655ed50850"><div class="ttname"><a href="structRefPolyData__t.html#a054cd38944c9548bd7f649655ed50850">RefPolyData_t::r3dpoly</a></div><div class="ttdeci">r3d_poly r3dpoly</div><div class="ttdef"><b>Definition:</b> cuts.h:41</div></div>
<div class="ttc" id="namespaceTangram_html_a98727a028a358f4388fadeb519401bce"><div class="ttname"><a href="namespaceTangram.html#a98727a028a358f4388fadeb519401bce">Tangram::make_counting_iterator</a></div><div class="ttdeci">counting_iterator make_counting_iterator(int const i)</div><div class="ttdef"><b>Definition:</b> tangram.h:144</div></div>
<div class="ttc" id="classr3d__poly__intersect__check_html"><div class="ttname"><a href="classr3d__poly__intersect__check.html">r3d_poly_intersect_check</a></div><div class="ttdoc">For a given data on a collection of polyhedra find their positions with respect to a convex shape giv...</div><div class="ttdef"><b>Definition:</b> cuts.h:50</div></div>
<div class="ttc" id="classr3d__split__operator_html"><div class="ttname"><a href="classr3d__split__operator.html">r3d_split_operator</a></div><div class="ttdoc">For a given data on a collection of polyhedra and a cutting plane, splits polyhedra with the plane an...</div><div class="ttdef"><b>Definition:</b> cuts.h:136</div></div>
<div class="ttc" id="structPolyHalfspaceData__t_html_aae79baaa04dc8e6a7957db39c74a0b59"><div class="ttname"><a href="structPolyHalfspaceData__t.html#aae79baaa04dc8e6a7957db39c74a0b59">PolyHalfspaceData_t::upper</a></div><div class="ttdeci">std::shared_ptr&lt; RefPolyData_t &gt; upper</div><div class="ttdef"><b>Definition:</b> cuts.h:128</div></div>
<div class="ttc" id="namespaceTangram_html_a470a7322feda68737ae68a53d47d2418"><div class="ttname"><a href="namespaceTangram.html#a470a7322feda68737ae68a53d47d2418">Tangram::overlapping_boxes</a></div><div class="ttdeci">bool overlapping_boxes(const BoundingBox_t&lt; D &gt; &amp;bb1, const BoundingBox_t&lt; D &gt; &amp;bb2, double dst_eps)</div><div class="ttdef"><b>Definition:</b> tangram.h:244</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_aff224788989415116c567aabc00f578b"><div class="ttname"><a href="classTangram_1_1MatPoly.html#aff224788989415116c567aabc00f578b">Tangram::MatPoly::bounding_box</a></div><div class="ttdeci">BoundingBox_t&lt; D &gt; bounding_box() const</div><div class="ttdef"><b>Definition:</b> MatPoly.h:387</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html"><div class="ttname"><a href="classTangram_1_1MatPoly.html">Tangram::MatPoly&lt; 3 &gt;</a></div></div>
<div class="ttc" id="namespaceTangram_html_a2364ea47380698d6b380574978c068da"><div class="ttname"><a href="namespaceTangram.html#a2364ea47380698d6b380574978c068da">Tangram::matpoly_to_r3dpoly</a></div><div class="ttdeci">void matpoly_to_r3dpoly(const MatPoly&lt; 3 &gt; &amp;mat_poly, r3d_poly &amp;r3dpoly)</div><div class="ttdoc">Converts a MatPoly to a polyhedron in R3D format. </div><div class="ttdef"><b>Definition:</b> split_r3d.h:41</div></div>
<div class="ttc" id="namespaceR3DPOLY_html_ae900fb35bd45f210fcc3cf379902b476ad326fe9d7be3050967d63e0f04bf0dc3"><div class="ttname"><a href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476ad326fe9d7be3050967d63e0f04bf0dc3">R3DPOLY::INSIDE</a></div><div class="ttdef"><b>Definition:</b> cuts.h:36</div></div>
<div class="ttc" id="structTangram_1_1Plane__t_html_aeb5db1642a6d790563f1ae78154de428"><div class="ttname"><a href="structTangram_1_1Plane__t.html#aeb5db1642a6d790563f1ae78154de428">Tangram::Plane_t::normal</a></div><div class="ttdeci">Vector&lt; D &gt; normal</div><div class="ttdef"><b>Definition:</b> tangram.h:174</div></div>
<div class="ttc" id="classTangram_1_1Point_html"><div class="ttname"><a href="classTangram_1_1Point.html">Tangram::Point</a></div><div class="ttdoc">Represents a point in an N-dimensional space. </div><div class="ttdef"><b>Definition:</b> Point.h:48</div></div>
<div class="ttc" id="namespaceTangram_html_a3d06c411beaeb41e4c0bfcc33aa2aad5"><div class="ttname"><a href="namespaceTangram.html#a3d06c411beaeb41e4c0bfcc33aa2aad5">Tangram::transform</a></div><div class="ttdeci">OutputIterator transform(InputIterator first, InputIterator last, OutputIterator result, UnaryFunction op)</div><div class="ttdef"><b>Definition:</b> tangram.h:150</div></div>
<div class="ttc" id="namespaceR3DPOLY_html_ae900fb35bd45f210fcc3cf379902b476a89677de1619bc4e547fb084eb72fcee9"><div class="ttname"><a href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476a89677de1619bc4e547fb084eb72fcee9">R3DPOLY::OUTSIDE</a></div><div class="ttdef"><b>Definition:</b> cuts.h:36</div></div>
<div class="ttc" id="cuts_8h_html_a2f4288fd84e1ea74595102bf44b87e31"><div class="ttname"><a href="cuts_8h.html#a2f4288fd84e1ea74595102bf44b87e31">sort_wrt_convex_poly</a></div><div class="ttdeci">void sort_wrt_convex_poly(const std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;polys_data, const Tangram::MatPoly&lt; 3 &gt; &amp;convex_matpoly, std::vector&lt; int &gt; &amp;iinterior_polys, std::vector&lt; int &gt; &amp;iinstersecting_polys, std::vector&lt; int &gt; &amp;iexterior_polys, const double dst_tol)</div><div class="ttdoc">Checks the positions of polyhedra with respect to a given convex shape. Can use multiple threads...</div><div class="ttdef"><b>Definition:</b> cuts.h:322</div></div>
<div class="ttc" id="r3d_8h_html_ab3f21c5ada02190326fbe535032bfbe0"><div class="ttname"><a href="r3d_8h.html#ab3f21c5ada02190326fbe535032bfbe0">r3d_clip</a></div><div class="ttdeci">void r3d_clip(r3d_poly *poly, const r3d_plane *planes, r3d_int nplanes)</div><div class="ttdoc">Clip a polyhedron against an arbitrary number of clip planes (find its intersection with a set of hal...</div></div>
<div class="ttc" id="structTangram_1_1BoundingBox__t_html"><div class="ttname"><a href="structTangram_1_1BoundingBox__t.html">Tangram::BoundingBox_t</a></div><div class="ttdef"><b>Definition:</b> tangram.h:232</div></div>
<div class="ttc" id="tangram_8h_html"><div class="ttname"><a href="tangram_8h.html">tangram.h</a></div></div>
<div class="ttc" id="structr3d__poly_html_a3a696a7627e82ee03e826c5ef5b19fe2"><div class="ttname"><a href="structr3d__poly.html#a3a696a7627e82ee03e826c5ef5b19fe2">r3d_poly::verts</a></div><div class="ttdeci">r3d_vertex verts[R3D_MAX_VERTS]</div><div class="ttdef"><b>Definition:</b> r3d.h:96</div></div>
<div class="ttc" id="structTangram_1_1Plane__t_html_a0de6ac6eb2b34ebc3d70ced8df621ce5"><div class="ttname"><a href="structTangram_1_1Plane__t.html#a0de6ac6eb2b34ebc3d70ced8df621ce5">Tangram::Plane_t::dist2origin</a></div><div class="ttdeci">double dist2origin</div><div class="ttdef"><b>Definition:</b> tangram.h:175</div></div>
<div class="ttc" id="structTangram_1_1Plane__t_html"><div class="ttname"><a href="structTangram_1_1Plane__t.html">Tangram::Plane_t&lt; 3 &gt;</a></div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_aa5681ccd23930482bb6b3c243fb4425c"><div class="ttname"><a href="classTangram_1_1MatPoly.html#aa5681ccd23930482bb6b3c243fb4425c">Tangram::MatPoly::faceted_matpoly</a></div><div class="ttdeci">void faceted_matpoly(MatPoly&lt; 2 &gt; *faceted_poly) const</div><div class="ttdoc">Facetization of the 2D polygon&amp;#39;s boundary: simply creates a copy of the polygon. </div></div>
<div class="ttc" id="classr3d__poly__intersect__check_html_a538e0681f2ed2a0b15c5d0eadce69391"><div class="ttname"><a href="classr3d__poly__intersect__check.html#a538e0681f2ed2a0b15c5d0eadce69391">r3d_poly_intersect_check::operator()</a></div><div class="ttdeci">R3DPOLY::Position operator()(const int checkID) const</div><div class="ttdoc">Finds the position of a polyhedron with respect to the shape given by convex_matpoly_. </div><div class="ttdef"><b>Definition:</b> cuts.h:87</div></div>
<div class="ttc" id="structr3d__plane_html"><div class="ttname"><a href="structr3d__plane.html">r3d_plane</a></div><div class="ttdef"><b>Definition:</b> r3d.h:76</div></div>
<div class="ttc" id="classr3d__poly__intersect__check_html_acea1efdd03e3a84b7140af6efe3bd586"><div class="ttname"><a href="classr3d__poly__intersect__check.html#acea1efdd03e3a84b7140af6efe3bd586">r3d_poly_intersect_check::r3d_poly_intersect_check</a></div><div class="ttdeci">r3d_poly_intersect_check(const std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;polys_data, const std::vector&lt; int &gt; &amp;IDs_to_check, const double dst_tol, const Tangram::MatPoly&lt; 3 &gt; &amp;convex_matpoly)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> cuts.h:60</div></div>
<div class="ttc" id="structr3d__poly_html_a49cb139c24b05f1ce30bc385f6938b50"><div class="ttname"><a href="structr3d__poly.html#a49cb139c24b05f1ce30bc385f6938b50">r3d_poly::nverts</a></div><div class="ttdeci">r3d_int nverts</div><div class="ttdef"><b>Definition:</b> r3d.h:97</div></div>
<div class="ttc" id="namespaceR3DPOLY_html_ae900fb35bd45f210fcc3cf379902b476"><div class="ttname"><a href="namespaceR3DPOLY.html#ae900fb35bd45f210fcc3cf379902b476">R3DPOLY::Position</a></div><div class="ttdeci">Position</div><div class="ttdef"><b>Definition:</b> cuts.h:35</div></div>
<div class="ttc" id="cuts_8h_html_ada8f3f960ae9834b492be70f14ca85fa"><div class="ttname"><a href="cuts_8h.html#ada8f3f960ae9834b492be70f14ca85fa">apply_poly</a></div><div class="ttdeci">void apply_poly(const std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;polys_data, const Tangram::MatPoly&lt; 3 &gt; &amp;mat_poly, std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;interior_data, std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;exterior_data, const double vol_tol, const double dst_tol, const bool convex_matpoly)</div><div class="ttdoc">Generates data for polyhedra inside and outside of a given shape. Can use multiple threads...</div><div class="ttdef"><b>Definition:</b> cuts.h:405</div></div>
<div class="ttc" id="structRefPolyData__t_html"><div class="ttname"><a href="structRefPolyData__t.html">RefPolyData_t</a></div><div class="ttdef"><b>Definition:</b> cuts.h:40</div></div>
<div class="ttc" id="structr3d__poly_html"><div class="ttname"><a href="structr3d__poly.html">r3d_poly</a></div><div class="ttdef"><b>Definition:</b> r3d.h:93</div></div>
<div class="ttc" id="namespaceTangram_html_a76a989a601d36db6dab4fcec22ed85fe"><div class="ttname"><a href="namespaceTangram.html#a76a989a601d36db6dab4fcec22ed85fe">Tangram::r3d_poly_bounding_box</a></div><div class="ttdeci">BoundingBox_t&lt; 3 &gt; r3d_poly_bounding_box(const r3d_poly &amp;r3dpoly)</div><div class="ttdef"><b>Definition:</b> split_r3d.h:625</div></div>
<div class="ttc" id="cuts_8h_html_a9693fcdc516437e3123f5b7a470474fb"><div class="ttname"><a href="cuts_8h.html#a9693fcdc516437e3123f5b7a470474fb">apply_plane</a></div><div class="ttdeci">void apply_plane(const std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;polys_data, const Tangram::Plane_t&lt; 3 &gt; &amp;planar_interface, std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;lower_hs_data, std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;upper_hs_data, const double vol_tol)</div><div class="ttdoc">Generates data for polyhedra in the lower and the upper half-spaces of a given plane. Can use multiple threads. </div><div class="ttdef"><b>Definition:</b> cuts.h:279</div></div>
<div class="ttc" id="structr3d__vertex_html_aaf9a4d5cce69d3fbca4ecd7d215071f5"><div class="ttname"><a href="structr3d__vertex.html#aaf9a4d5cce69d3fbca4ecd7d215071f5">r3d_vertex::pos</a></div><div class="ttdeci">r3d_rvec3 pos</div><div class="ttdef"><b>Definition:</b> r3d.h:87</div></div>
<div class="ttc" id="classTangram_1_1MatPoly_html_aba885f75525c109661a08cb41a413a5b"><div class="ttname"><a href="classTangram_1_1MatPoly.html#aba885f75525c109661a08cb41a413a5b">Tangram::MatPoly::face_planes</a></div><div class="ttdeci">void face_planes(std::vector&lt; Plane_t&lt; D &gt; &gt; &amp;fplanes) const</div><div class="ttdoc">For every face, returns a plane containing that face. Important: faces should be planar, so you might need to facetize the MatPoly first. In 2D, faces of size below the distance tolerance will be omitted. In 3D, faces should have at least three edges of size above the distance tolerance. If the number of valid planes is less than four, empty vector will be returned. </div></div>
<div class="ttc" id="cuts_8h_html_aec6506dfb91f930088d22cde1b317345"><div class="ttname"><a href="cuts_8h.html#aec6506dfb91f930088d22cde1b317345">extract_data</a></div><div class="ttdeci">void extract_data(const std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;polys_data, const std::vector&lt; int &gt; &amp;set_ipolys, std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;set_data)</div><div class="ttdoc">Given data on polyhedra, generates its subset based on given IDs. </div><div class="ttdef"><b>Definition:</b> cuts.h:382</div></div>
<div class="ttc" id="unionr3d__rvec3_html_ab127c0310533e3caaafcad80b7280fe1"><div class="ttname"><a href="unionr3d__rvec3.html#ab127c0310533e3caaafcad80b7280fe1">r3d_rvec3::xyz</a></div><div class="ttdeci">r3d_real xyz[3]</div><div class="ttdef"><b>Definition:</b> r3d.h:59</div></div>
<div class="ttc" id="cuts_8h_html_ae9945c15826a9c1b5c141db314b7f8b4"><div class="ttname"><a href="cuts_8h.html#ae9945c15826a9c1b5c141db314b7f8b4">factorial</a></div><div class="ttdeci">unsigned int factorial(unsigned int n)</div><div class="ttdef"><b>Definition:</b> cuts.h:505</div></div>
<div class="ttc" id="classr3d__split__operator_html_afc39655554f0293936377b67ce8bfe87"><div class="ttname"><a href="classr3d__split__operator.html#afc39655554f0293936377b67ce8bfe87">r3d_split_operator::r3d_split_operator</a></div><div class="ttdeci">r3d_split_operator(const std::vector&lt; std::shared_ptr&lt; RefPolyData_t &gt; &gt; &amp;polys_data, const r3d_plane &amp;cutting_plane, const double vol_tol)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> cuts.h:145</div></div>
<div class="ttc" id="r3d_8h_html_ace7c6f2c67e44a0a24c13f4cd1dbf138"><div class="ttname"><a href="r3d_8h.html#ace7c6f2c67e44a0a24c13f4cd1dbf138">R3D_NUM_MOMENTS</a></div><div class="ttdeci">#define R3D_NUM_MOMENTS(order)</div><div class="ttdoc">Integrate a polynomial density over a polyhedron using simplicial decomposition. Uses the fast recurs...</div><div class="ttdef"><b>Definition:</b> r3d.h:154</div></div>
<div class="ttc" id="r3d_8h_html_aad337c9fbabbd571b25490c27f3709d9"><div class="ttname"><a href="r3d_8h.html#aad337c9fbabbd571b25490c27f3709d9">r3d_split</a></div><div class="ttdeci">void r3d_split(r3d_poly *inpolys, r3d_int npolys, r3d_plane plane, r3d_poly *out_pos, r3d_poly *out_neg)</div><div class="ttdoc">Splits a list of polyhedra across a single plane. </div></div>
<div class="ttc" id="cuts_8h_html_a1199a516296a6316cbcf2fc27d56a3a6"><div class="ttname"><a href="cuts_8h.html#a1199a516296a6316cbcf2fc27d56a3a6">R3D_POLY_ORDER</a></div><div class="ttdeci">#define R3D_POLY_ORDER</div><div class="ttdef"><b>Definition:</b> cuts.h:24</div></div>
<div class="ttc" id="namespaceTangram_html_a71c39deca72d48990415ee231a9170b1"><div class="ttname"><a href="namespaceTangram.html#a71c39deca72d48990415ee231a9170b1">Tangram::vector</a></div><div class="ttdeci">std::vector&lt; T &gt; vector</div><div class="ttdef"><b>Definition:</b> tangram.h:138</div></div>
<div class="ttc" id="split__r3d_8h_html"><div class="ttname"><a href="split__r3d_8h.html">split_r3d.h</a></div><div class="ttdoc">Routines for splitting convex or non-convex MatPoly&amp;#39;s by a cutting plane. Uses R3D. A convex MatPoly will be split into two MatPoly&amp;#39;s. A non-convex MatPoly will be decomposed into convex polyhedra using its centroid, several MatPoly&amp;#39;s could be returned for each half-plane. All the faces of the input MatPoly are assumed to be planar and no additional facetization is performed, so when sequentially splitting of a faceted MatPoly, no additional facets will be introduced. </div></div>
<div class="ttc" id="namespaceR3DPOLY_html"><div class="ttname"><a href="namespaceR3DPOLY.html">R3DPOLY</a></div><div class="ttdef"><b>Definition:</b> cuts.h:34</div></div>
</div><!-- fragment --></div><!-- contents -->
<!--
This file is part of the Ristra tangram project.
Please see the license file at the root of this repository, or at:
https://github.com/laristra/tangram/blob/master/LICENSE
-->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<!--<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address> -->
<footer id="footer" class="footer">
  <div class="container">
    <div class="row test-muted">
      <div class="footer-row col-md-6">Copyright &copy; 2019
	<a href="http://lanl.gov"> Triad National Security, LLC</a>
	All Rights Reserved.
      </div>
      <div class="footer-row col-md-2">
	<a href="https://github.com/laristra/tangram/blob/master/LICENSE">
	  BSD LICENSE
	</a>
      </div>
      <div class="footer-row col-md-2">
	LA-CC-17-133
      </div>
      <div class="footer-row col-md-1">
	<a href="mailto:portage@lanl.gov">
	  <i class="fa fa-envelope-o fa-2x"></i>
	</a>
      </div>
      <div class="footer-row col-md-1">
	<a href="https://github.com/laristra/tangram">
	  <i class="fa fa-github fa-2x"></i>
	</a>
      </div>
    </div>
  </div>
</footer>
<script type="text/javascript" src="doxy-boot.js"></script>
</body>
</html>
